<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <title>MLS - SMKS Muhammadiyah 1 Genteng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* AI Chat Styles */
        .ai-chat-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 9999;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.2);
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* Hide AI button on desktop - will be shown inline on mobile */
        @media (min-width: 769px) {
            .ai-chat-button {
                display: flex;
            }
        }

        .ai-chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.6);
        }

        .ai-chat-button.pulse {
            animation: ai-pulse 2s infinite;
        }

        @keyframes ai-pulse {
            0% { box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4); }
            50% { box-shadow: 0 4px 20px rgba(102, 126, 234, 0.8), 0 0 0 10px rgba(102, 126, 234, 0.1); }
            100% { box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4); }
        }

        /* AI Chat Modal - Full Screen Modal Style */
        .ai-chat-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 16px;
            box-sizing: border-box;
        }

        .ai-chat-container {
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            width: 100%;
            max-width: 600px;
            height: 80vh;
            max-height: 700px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            transform: scale(0.95);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .ai-chat-container.show {
            transform: scale(1);
            opacity: 1;
        }

        .ai-chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-radius: 20px 20px 0 0;
        }

        .ai-chat-header h3 {
            color: white;
            font-weight: 700;
            font-size: 16px;
            margin: 0;
        }

        .ai-chat-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .ai-chat-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .ai-message {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: slideInMessage 0.3s ease;
        }

        .ai-message.user {
            flex-direction: row-reverse;
        }

        .ai-message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .ai-message-avatar.ai {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .ai-message-avatar.user {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .ai-message-content {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 16px;
            border-radius: 16px;
            color: white;
            max-width: 280px;
            word-wrap: break-word;
            line-height: 1.5;
            font-size: 14px;
        }

        .ai-message.user .ai-message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .ai-message.ai .ai-message-content {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-chat-input-container {
            padding: 16px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 12px 16px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .ai-chat-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3);
        }

        .ai-chat-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .ai-chat-send {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .ai-chat-send:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .ai-chat-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .ai-typing {
            display: flex;
            align-items: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-style: italic;
        }

        .ai-typing-dots {
            display: flex;
            gap: 4px;
        }

        .ai-typing-dot {
            width: 6px;
            height: 6px;
            background: #667eea;
            border-radius: 50%;
            animation: typingDot 1.4s infinite;
        }

        .ai-typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .ai-typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDot {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-10px); opacity: 1; }
        }

        @keyframes slideInMessage {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .ai-quick-action {
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: #667eea;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-quick-action:hover {
            background: rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.5);
            color: white;
        }

        /* Mobile AI Button - Inline Style */
        .ai-chat-button-mobile {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50px;
            padding: 14px 24px;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            display: none;
            align-items: center;
            justify-content: center;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .ai-chat-button-mobile:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.6);
        }

        .ai-chat-button-mobile:active {
            transform: translateY(0) scale(0.98);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .ai-chat-container {
                width: 100%;
                height: 90vh;
                max-height: calc(100vh - 32px);
                border-radius: 16px;
            }

            /* Hide fixed AI button on mobile - will use inline button instead */
            .ai-chat-button {
                display: none !important;
            }

            /* Show mobile AI button */
            .ai-chat-button-mobile {
                display: flex !important;
                width: 100% !important;
            }
        }

            .ai-message-content {
                max-width: 220px;
                font-size: 13px;
            }

            .ai-chat-input {
                font-size: 16px; /* Prevent zoom on iOS */
            }
        

        /* Notification Badge */
        .ai-notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #f5576c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        /* Optimized CSS Variables for Mobile */
        :root {
            --primary: #667eea;
            --secondary: #f093fb;
            --accent: #00f2fe;
            --dark: #1a1a1a;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --neon-blue: #00f2fe;
            --neon-purple: #667eea;
            --neon-pink: #f093fb;
            --neon-green: #4ade80;
        }

        /* Mobile Performance Optimization */
        @media (max-width: 768px) {
            * {
                -webkit-transform: translateZ(0);
                transform: translateZ(0);
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            
            body {
                background: #0f0f23 !important;
                overflow-x: hidden;
                -webkit-overflow-scrolling: touch;
            }
            
            .bg-gray-50 {
                background: #0f0f23 !important;
            }
            
            /* Disable heavy effects on mobile */
            .cyber-grid,
            .pulse-ring,
            .cyber-scan,
            .data-flow {
                display: none !important;
            }
            
            /* Optimize animations for mobile */
            * {
                animation-duration: 0.2s !important;
                transition-duration: 0.2s !important;
            }
            
            /* Reduce blur effects */
            .glass,
            .glass-dark,
            .modern-card {
                backdrop-filter: none !important;
                -webkit-backdrop-filter: none !important;
            }
        }

        /* Optimized Glassmorphism Effects */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px 0 rgba(31, 38, 135, 0.2);
        }

        .glass-dark {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Desktop only blur effects */
        @media (min-width: 769px) {
            .glass {
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
                box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            }

            .glass-dark {
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
            }
        }

        /* Optimized Animations for Mobile */
        @keyframes float-simple {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow-pulse {
            0%, 100% { box-shadow: 0 0 10px rgba(102, 126, 234, 0.3); }
            50% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        @keyframes fade-in {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Disable complex animations on mobile */
        @media (max-width: 768px) {
            @keyframes float-simple {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-5px); }
            }
            
            @keyframes glow-pulse {
                0%, 100% { box-shadow: 0 0 5px rgba(102, 126, 234, 0.2); }
                50% { box-shadow: 0 0 10px rgba(102, 126, 234, 0.3); }
            }
        }

        /* Optimized Background for Mobile */
        .ultra-modern-bg {
            background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e);
            position: relative;
            overflow: hidden;
        }

        .ultra-modern-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
        }

        /* Desktop only complex backgrounds */
        @media (min-width: 769px) {
            .ultra-modern-bg {
                background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e, #0f3460);
                background-size: 400% 400%;
                animation: gradient-shift 20s ease infinite;
            }

            .ultra-modern-bg::before {
                background: 
                    radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.2) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.2) 0%, transparent 50%);
            }
        }

        /* Dashboard Specific Styles */
        .dashboard-bg {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            position: relative;
        }

        .dashboard-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(0, 242, 254, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(240, 147, 251, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        /* Cyber Grid */
        .cyber-grid {
            background-image: 
                linear-gradient(rgba(0, 242, 254, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 242, 254, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.3;
        }

        /* Optimized Modern Cards */
        .modern-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .modern-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.3s ease;
        }

        /* Desktop hover effects */
        @media (min-width: 769px) {
            .modern-card {
                backdrop-filter: blur(15px);
                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            }

            .modern-card::before {
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
                transition: left 0.5s;
            }

            .modern-card:hover::before {
                left: 100%;
            }

            .modern-card:hover {
                transform: translateY(-10px) scale(1.02);
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
                border-color: rgba(255, 255, 255, 0.3);
            }
        }

        /* Mobile touch effects */
        @media (max-width: 768px) {
            .modern-card:active {
                transform: scale(0.98);
                border-color: rgba(255, 255, 255, 0.2);
            }
        }

        /* Neon Buttons */
        .neon-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 50px;
            padding: 12px 30px;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .neon-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .neon-btn:hover::before {
            left: 100%;
        }

        .neon-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
            animation: glow-pulse 2s infinite;
        }

        /* Solid Color Text */
        .holographic {
            color: #667eea;
            font-weight: 800;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        /* Desktop enhanced color effects */
        @media (min-width: 769px) {
            .holographic {
                color: #667eea;
                text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
            }
        }

        /* Mobile optimized color */
        @media (max-width: 768px) {
            .holographic {
                color: #667eea;
                text-shadow: 0 0 15px rgba(102, 126, 234, 0.3);
            }
        }

        /* Stats Cards with Neon Effects */
        .stat-card {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .stat-card:hover::before {
            transform: translateX(100%);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-blue);
            box-shadow: 0 10px 30px rgba(0, 242, 254, 0.3);
        }

        /* Data Table Futuristic */
        .futuristic-table {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
        }

        .futuristic-table th {
            background: rgba(0, 242, 254, 0.1);
            color: var(--neon-blue);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(0, 242, 254, 0.3);
        }

        .futuristic-table tr:hover {
            background: rgba(0, 242, 254, 0.05);
            transform: scale(1.01);
            transition: all 0.3s ease;
        }

        /* Action Buttons with Special Effects */
        .action-btn {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .action-btn:hover {
            transform: translateY(-3px) scale(1.05);
        }

        /* Notification System */
        .notification {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: white;
            padding: 16px;
            margin-bottom: 10px;
            transform: translateX(400px);
            animation: slideInRight 0.5s ease forwards;
        }

        @keyframes slideInRight {
            to { transform: translateX(0); }
        }

        /* Loading Spinner */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid #00f2fe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Scroll Animations */
        .scroll-reveal {
            opacity: 0;
            transform: translateY(50px);
            transition: all 0.6s ease;
        }

        .scroll-reveal.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        /* Data Flow Animation */
        .data-flow {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--neon-blue);
            border-radius: 50%;
            animation: data-flow 3s linear infinite;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        /* Pulse Ring Effect */
        .pulse-ring {
            position: absolute;
            border: 2px solid var(--neon-blue);
            border-radius: 50%;
            animation: pulse-ring 2s ease-out infinite;
        }

        /* Cyber Scan Effect */
        .cyber-scan {
            position: absolute;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), transparent);
            animation: cyber-scan 3s ease-in-out infinite;
            opacity: 0.7;
        }

        /* Modern Navigation */
        .modern-nav {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 242, 254, 0.3);
        }

        /* Enhanced Mobile Responsive Design */
        @media (max-width: 768px) {
            .holographic {
                font-size: 2rem;
                line-height: 1.2;
            }
            
            .modern-card {
                margin: 8px;
                border-radius: 15px;
            }

            /* Optimize text sizes for mobile */
            h1 { font-size: 2.5rem !important; }
            h2 { font-size: 2rem !important; }
            h3 { font-size: 1.5rem !important; }
            
            /* Reduce padding for mobile */
            .px-8 { padding-left: 1rem !important; padding-right: 1rem !important; }
            .py-8 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important; }
            
            /* Optimize button sizes */
            .neon-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            /* Reduce margins */
            .mb-8 { margin-bottom: 1.5rem !important; }
            .mb-6 { margin-bottom: 1rem !important; }
            
            /* Modal specific mobile optimizations */
            .modern-card {
                max-height: 85vh;
                margin: 8px;
            }
            
            /* Improve touch targets */
            button, input, select, textarea {
                min-height: 44px;
            }
            
            /* Better spacing for form elements */
            .space-y-2 > * + * {
                margin-top: 0.75rem;
            }
            
            /* Optimize modal close button */
            .absolute.top-4.right-4 {
                top: 12px;
                right: 12px;
                width: 36px;
                height: 36px;
                display: flex;
                align-items: center;
                justify-content: center;
                background: rgba(0, 0, 0, 0.5);
                border-radius: 50%;
            }
        }

        /* Tablet optimizations */
        @media (min-width: 769px) and (max-width: 1024px) {
            .holographic {
                font-size: 3rem;
            }
            
            h1 { font-size: 3.5rem !important; }
            h2 { font-size: 2.5rem !important; }
        }

        /* Modal Positioning - Perfect Centering at Current Viewport */
        .modal-backdrop {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            /* Ensure modal appears at current viewport position */
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* Modal container that stays centered in viewport */
        .modal-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            box-sizing: border-box;
        }

        /* Ensure modal content is always visible and centered */
        .modal-content {
            position: relative;
            max-height: calc(100vh - 32px);
            overflow-y: auto;
            margin: auto;
        }

        /* Modal Animation Styles */
        .modal-show {
            opacity: 1 !important;
            transform: scale(1) !important;
        }

        .modal-hide {
            opacity: 0 !important;
            transform: scale(0.95) !important;
        }

        /* Mobile Modal Perfect Centering */
        @media (max-width: 768px) {
            .modal-backdrop {
                padding: 12px !important;
                align-items: center !important;
                justify-content: center !important;
                min-height: 100vh !important;
                min-height: 100dvh !important; /* Dynamic viewport height for mobile */
            }
            
            .modal-backdrop .modern-card {
                margin: 0 !important;
                border-radius: 16px !important;
                max-height: 92vh !important;
                max-height: 92dvh !important;
                width: 100% !important;
                max-width: calc(100vw - 24px) !important;
                overflow-y: auto !important;
                position: relative !important;
                transform: none !important;
            }
            
            /* Perfect close button positioning */
            .modal-backdrop .modern-card .absolute.top-3.right-3 {
                position: absolute !important;
                top: 16px !important;
                right: 16px !important;
                width: 44px !important;
                height: 44px !important;
                border-radius: 50% !important;
                background: rgba(0, 0, 0, 0.9) !important;
                backdrop-filter: blur(10px) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                z-index: 10 !important;
                border: 2px solid rgba(255, 255, 255, 0.3) !important;
                font-size: 18px !important;
                color: #ffffff !important;
                transition: all 0.3s ease !important;
            }
            
            .modal-backdrop .modern-card .absolute.top-3.right-3:hover {
                background: rgba(255, 0, 0, 0.8) !important;
                border-color: rgba(255, 255, 255, 0.5) !important;
                transform: scale(1.1) !important;
            }
            
            /* Optimize modal content padding */
            .modal-backdrop .modern-card > div {
                padding: 20px !important;
            }
            
            /* Better form spacing on mobile */
            .modal-backdrop .space-y-2 > * + * {
                margin-top: 16px !important;
            }
            
            .modal-backdrop .space-y-4 > * + * {
                margin-top: 20px !important;
            }
            
            .modal-backdrop .space-y-6 > * + * {
                margin-top: 24px !important;
            }
            
            /* Better section spacing */
            .modal-backdrop .glass-dark {
                margin-bottom: 20px !important;
                padding: 20px !important;
            }
            
            /* Optimize input fields for mobile */
            .modal-backdrop input,
            .modal-backdrop select,
            .modal-backdrop textarea {
                font-size: 16px !important; /* Prevent zoom on iOS */
                padding: 12px 16px !important;
                border-radius: 12px !important;
            }
            
            /* Better button sizing */
            .modal-backdrop button {
                min-height: 48px !important;
                padding: 12px 20px !important;
                border-radius: 12px !important;
                font-size: 16px !important;
            }
            
            /* Optimize text sizes */
            .modal-backdrop h2 {
                font-size: 24px !important;
                line-height: 1.3 !important;
            }
            
            .modal-backdrop h3 {
                font-size: 20px !important;
                line-height: 1.3 !important;
            }
            
            .modal-backdrop p {
                font-size: 14px !important;
                line-height: 1.5 !important;
            }
            
            .modal-backdrop label {
                font-size: 14px !important;
                font-weight: 600 !important;
            }
        }

        /* Tablet Modal Optimizations */
        @media (min-width: 769px) and (max-width: 1024px) {
            .modal-backdrop {
                padding: 20px !important;
            }
            
            .modal-backdrop .modern-card {
                max-height: 90vh !important;
                border-radius: 20px !important;
            }
        }

        /* Desktop Modal Optimizations */
        @media (min-width: 1025px) {
            .modal-backdrop {
                padding: 24px !important;
            }
            
            .modal-backdrop .modern-card {
                max-height: 85vh !important;
                border-radius: 24px !important;
            }
        }

        /* SweetAlert Mobile Perfect Centering */
        .mobile-swal-popup {
            font-size: 14px !important;
            border-radius: 16px !important;
        }

        .mobile-swal-title {
            font-size: 20px !important;
            line-height: 1.3 !important;
            padding: 0.75rem !important;
        }

        .mobile-swal-content {
            font-size: 14px !important;
            line-height: 1.5 !important;
            padding: 0.5rem !important;
        }

        @media (max-width: 768px) {
            /* Perfect SweetAlert centering on mobile */
            .swal2-container {
                padding: 16px !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                min-height: 100vh !important;
                min-height: 100dvh !important;
            }
            
            .swal2-popup {
                width: 100% !important;
                max-width: calc(100vw - 32px) !important;
                margin: 0 !important;
                padding: 20px !important;
                font-size: 16px !important;
                border-radius: 16px !important;
                position: relative !important;
                transform: none !important;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5) !important;
            }
            
            .swal2-title {
                font-size: 20px !important;
                line-height: 1.3 !important;
                margin-bottom: 12px !important;
                padding: 0 !important;
                font-weight: 700 !important;
            }
            
            .swal2-content {
                font-size: 14px !important;
                line-height: 1.5 !important;
                margin: 12px 0 !important;
                padding: 0 !important;
            }
            
            .swal2-actions {
                margin-top: 20px !important;
                gap: 12px !important;
                flex-direction: column !important;
            }
            
            .swal2-confirm,
            .swal2-cancel {
                font-size: 16px !important;
                padding: 14px 24px !important;
                border-radius: 12px !important;
                min-height: 48px !important;
                width: 100% !important;
                font-weight: 600 !important;
                border: none !important;
                cursor: pointer !important;
            }
            
            .swal2-confirm {
                order: 1 !important;
            }
            
            .swal2-cancel {
                order: 2 !important;
                background: rgba(255, 255, 255, 0.1) !important;
                color: #ffffff !important;
            }
            
            .swal2-html-container {
                font-size: 14px !important;
                line-height: 1.5 !important;
                text-align: left !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            .swal2-html-container ul {
                text-align: left !important;
                padding-left: 20px !important;
                margin: 12px 0 !important;
            }
            
            .swal2-html-container li {
                margin-bottom: 8px !important;
                line-height: 1.4 !important;
            }
            
            .swal2-html-container p {
                margin-bottom: 12px !important;
                line-height: 1.5 !important;
            }
            
            .swal2-html-container hr {
                margin: 16px 0 !important;
                border: none !important;
                height: 1px !important;
                background: rgba(255, 255, 255, 0.2) !important;
            }
            
            /* Close button optimization */
            .swal2-close {
                width: 40px !important;
                height: 40px !important;
                font-size: 20px !important;
                line-height: 40px !important;
                top: 12px !important;
                right: 12px !important;
                background: rgba(0, 0, 0, 0.5) !important;
                border-radius: 50% !important;
                color: #ffffff !important;
            }
            
            /* Input fields in SweetAlert */
            .swal2-input {
                font-size: 16px !important;
                padding: 12px 16px !important;
                border-radius: 12px !important;
                border: 1px solid rgba(255, 255, 255, 0.3) !important;
                background: rgba(0, 0, 0, 0.3) !important;
                color: #ffffff !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }
            
            .swal2-input:focus {
                border-color: #667eea !important;
                outline: none !important;
                box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3) !important;
            }
        }

        /* Performance optimizations for all devices */
        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }

        img, video {
            max-width: 100%;
            height: auto;
            will-change: auto;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Optimize heavy elements */
        .modern-card,
        .stat-card,
        .futuristic-table {
            will-change: transform;
            contain: layout style paint;
        }
        
        /* Lazy loading optimization */
        .scroll-reveal {
            content-visibility: auto;
            contain-intrinsic-size: 200px;
        }

        /* Reduce motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#667eea',
                        secondary: '#f093fb',
                        accent: '#00f2fe',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50">
    <!-- Ultra Modern Navigation -->
    <nav class="modern-nav sticky top-0 z-50 transition-all duration-500">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center scroll-reveal">
                    <div class="flex-shrink-0 flex items-center">
                        <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center mr-2 sm:mr-4 shadow-lg">
                            <img src="images/LOGO BARU SMK MUHI.png">
                        </div>
                        <div class="min-w-0 flex-1">
                            <h1 class="text-lg sm:text-2xl font-bold truncate">
                                <span class="holographic">MLS</span>
                            </h1>
                            <p class="text-xs text-gray-300 font-medium truncate hidden sm:block">SMKS Muhammadiyah 1 Genteng</p>
                            <p class="text-xs text-gray-300 font-medium truncate sm:hidden">SMK Muh 1 Genteng</p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-1 sm:space-x-3 scroll-reveal">
                    <button onclick="showAbout()" class="glass px-2 sm:px-4 py-2 rounded-full text-white font-medium hover:bg-white hover:bg-opacity-20 transition-all duration-300 transform hover:scale-105 text-xs sm:text-sm">
                        <i class="fas fa-info-circle text-sm"></i>
                        <span class="hidden lg:inline ml-1">Tentang</span>
                    </button>
                    <button onclick="accessDashboard()" class="glass px-2 sm:px-4 py-2 rounded-full text-white font-medium bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 transition-all duration-300 transform hover:scale-105 shadow-lg text-xs sm:text-sm">
                        <i class="fas fa-tachometer-alt text-sm"></i>
                        <span class="hidden lg:inline ml-1">Dashboard</span>
                    </button>
                    <button onclick="showLogin()" class="px-2 sm:px-5 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-full font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-xs sm:text-sm">
                        <i class="fas fa-sign-in-alt text-sm"></i>
                        <span class="hidden lg:inline ml-1">Login</span>
                    </button>
                    <button onclick="showRegister()" class="glass px-2 sm:px-4 py-2 rounded-full text-white font-medium bg-gradient-to-r from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600 transition-all duration-300 transform hover:scale-105 shadow-lg text-xs sm:text-sm">
                        <i class="fas fa-user-plus text-sm"></i>
                        <span class="hidden lg:inline ml-1">Daftar</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Ultra Modern Hero Section -->
    <section class="ultra-modern-bg text-white min-h-screen flex items-center relative overflow-hidden">
        <!-- Cyber Grid Background -->
        <div class="cyber-grid absolute inset-0 opacity-20"></div>
        
        <!-- Optimized Effects - Desktop Only -->
        <div class="hidden lg:block">
            <!-- Floating Shapes -->
            <div class="absolute inset-0 pointer-events-none">
                <div class="absolute top-20 left-10 w-16 h-16 glass rounded-2xl" style="animation: float-simple 4s ease-in-out infinite;"></div>
                <div class="absolute top-40 right-20 w-12 h-12 glass rounded-full" style="animation: float-simple 4s ease-in-out infinite; animation-delay: 2s;"></div>
                <div class="absolute bottom-40 left-20 w-20 h-20 glass rounded-3xl" style="animation: float-simple 4s ease-in-out infinite; animation-delay: 4s;"></div>
            </div>
        </div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10 py-8 sm:py-0">
            <div class="scroll-reveal">
                <h1 class="text-3xl sm:text-4xl md:text-7xl font-black mb-6 sm:mb-8 leading-tight">
                    <span class="holographic">MODUL LATIHAN</span>
                    <br>
                    <span class="text-2xl sm:text-3xl md:text-5xl holographic">SISWA</span>
                </h1>
            </div>
            
            <div class="scroll-reveal" style="animation-delay: 0.2s;">
                <div class="glass rounded-2xl p-4 sm:p-6 mb-6 sm:mb-8 inline-block">
                    <p class="text-lg sm:text-2xl md:text-3xl font-bold mb-2">
                        SMKS Muhammadiyah 1 Genteng
                    </p>
                    <div class="w-16 sm:w-20 h-1 bg-gradient-to-r from-blue-400 to-purple-600 mx-auto rounded-full"></div>
                </div>
            </div>
            
            <div class="scroll-reveal" style="animation-delay: 0.4s;">
                <p class="text-base sm:text-xl md:text-2xl mb-8 sm:mb-12 max-w-4xl mx-auto font-light leading-relaxed px-4">
                    Platform pembelajaran digital masa depan untuk siswa jurusan 
                    <span class="holographic font-bold">RPL</span> dan 
                    <span class="holographic font-bold">TKJ</span> dengan teknologi terdepan
                </p>
            </div>
            
            <div class="scroll-reveal flex flex-col sm:flex-row gap-4 sm:gap-6 justify-center items-center px-4 max-w-md sm:max-w-none mx-auto" style="animation-delay: 0.6s;">
                <button onclick="showRegister()" class="neon-btn text-base sm:text-base lg:text-lg px-8 sm:px-8 lg:px-10 py-4 sm:py-4 transform hover:scale-110 w-full sm:w-auto min-h-[56px] flex items-center justify-center">
                    <i class="fas fa-rocket mr-3 text-lg"></i>Mulai Petualangan
                </button>
                <button onclick="showAbout()" class="glass px-8 sm:px-8 lg:px-10 py-4 sm:py-4 rounded-full text-white font-medium hover:bg-white hover:bg-opacity-20 transition-all duration-300 transform hover:scale-105 w-full sm:w-auto text-base sm:text-base min-h-[56px] flex items-center justify-center">
                    <i class="fas fa-play mr-3 text-lg"></i>Lihat Demo
                </button>
                <!-- Mobile AI Assistant Button -->
                <button onclick="toggleAIChat()" class="ai-chat-button-mobile">
                    <i class="fas fa-robot mr-3 text-lg"></i>Tanya AI Assistant
                </button>
            </div>
        </div>
    </section>

    <!-- Ultra Modern Program Section -->
    <section class="py-20 bg-black relative overflow-hidden">
        <!-- Background Effects -->
        <div class="absolute inset-0 bg-gradient-to-br from-gray-900 via-black to-gray-900"></div>
        <div class="cyber-grid absolute inset-0 opacity-10"></div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-12 sm:mb-16 scroll-reveal px-4">
                <h2 class="text-3xl sm:text-4xl md:text-6xl font-black mb-4 sm:mb-6">
                    <span class="holographic">PROGRAM KEAHLIAN</span>
                </h2>
                <div class="w-24 sm:w-32 h-1 bg-gradient-to-r from-blue-400 to-purple-600 mx-auto rounded-full mb-4 sm:mb-6"></div>
                <p class="text-base sm:text-xl text-gray-300 max-w-3xl mx-auto leading-relaxed">
                    Pilih jalur masa depan Anda dengan teknologi terdepan dan pembelajaran yang revolusioner
                </p>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-8 sm:gap-12 px-4">
                <!-- RPL Card -->
                <div class="modern-card p-6 sm:p-8 scroll-reveal group">
                    <div class="text-center">
                        <!-- Icon with 3D Effect -->
                        <div class="relative mb-6 sm:mb-8">
                            <div class="w-20 h-20 sm:w-24 sm:h-24 mx-auto bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-2xl transform group-hover:rotate-12 transition-all duration-500">
                                <i class="fas fa-code text-2xl sm:text-3xl text-white"></i>
                            </div>
                            <div class="absolute -top-2 -right-2 w-5 h-5 sm:w-6 sm:h-6 bg-gradient-to-r from-pink-500 to-red-500 rounded-full animate-pulse"></div>
                        </div>
                        
                        <h3 class="text-2xl sm:text-3xl font-bold text-white mb-4 sm:mb-6 group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-blue-400 group-hover:to-purple-600 transition-all duration-300">
                            Rekayasa Perangkat Lunak
                        </h3>
                        
                        <!-- Featured Module -->
                        <div class="glass-dark rounded-2xl p-6 mb-8 transform group-hover:scale-105 transition-all duration-300">
                            <div class="flex items-center justify-center mb-3">
                                <i class="fas fa-star text-yellow-400 mr-2"></i>
                                <h4 class="font-bold text-blue-400">Modul Unggulan</h4>
                            </div>
                            <p class="text-2xl font-bold text-white">Java Programming</p>
                            <div class="w-full bg-gray-700 rounded-full h-2 mt-3">
                                <div class="bg-gradient-to-r from-blue-400 to-purple-600 h-2 rounded-full w-4/5"></div>
                            </div>
                        </div>
                        
                        <button onclick="selectJurusan('RPL')" class="w-full neon-btn py-4 text-lg font-bold transform hover:scale-105">
                            <i class="fas fa-rocket mr-3"></i>Pilih RPL
                        </button>
                    </div>
                </div>

                <!-- TKJ Card -->
                <div class="modern-card p-6 sm:p-8 scroll-reveal group" style="animation-delay: 0.2s;">
                    <div class="text-center">
                        <!-- Icon with 3D Effect -->
                        <div class="relative mb-6 sm:mb-8">
                            <div class="w-20 h-20 sm:w-24 sm:h-24 mx-auto bg-gradient-to-r from-green-500 to-teal-600 rounded-2xl flex items-center justify-center shadow-2xl transform group-hover:rotate-12 transition-all duration-500">
                                <i class="fas fa-network-wired text-2xl sm:text-3xl text-white"></i>
                            </div>
                            <div class="absolute -top-2 -right-2 w-5 h-5 sm:w-6 sm:h-6 bg-gradient-to-r from-orange-500 to-red-500 rounded-full animate-pulse"></div>
                        </div>
                        
                        <h3 class="text-2xl sm:text-3xl font-bold text-white mb-4 sm:mb-6 group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-green-400 group-hover:to-teal-600 transition-all duration-300">
                            Teknik Komputer & Jaringan
                        </h3>
                        
                        <!-- Featured Module -->
                        <div class="glass-dark rounded-2xl p-6 mb-8 transform group-hover:scale-105 transition-all duration-300">
                            <div class="flex items-center justify-center mb-3">
                                <i class="fas fa-star text-yellow-400 mr-2"></i>
                                <h4 class="font-bold text-green-400">Modul Unggulan</h4>
                            </div>
                            <p class="text-2xl font-bold text-white">Basic IoT</p>
                            <div class="w-full bg-gray-700 rounded-full h-2 mt-3">
                                <div class="bg-gradient-to-r from-green-400 to-teal-600 h-2 rounded-full w-4/5"></div>
                            </div>
                        </div>
                        
                        <button onclick="selectJurusan('TKJ')" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 rounded-full font-bold text-lg hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-2xl">
                            <i class="fas fa-microchip mr-3"></i>Pilih TKJ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal-backdrop hidden bg-black bg-opacity-50">
        <div class="modal-container">
            <div class="modal-content modern-card max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="loginModalContent">
                <button onclick="hideLogin()" class="absolute top-3 right-3 w-8 h-8 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white transition-all duration-300 z-10">
                    <i class="fas fa-times text-sm"></i>
                </button>
                <div class="p-6 sm:p-8">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4 shadow-2xl">
                            <i class="fas fa-sign-in-alt text-2xl text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold">
                            <span class="holographic">Login</span>
                        </h2>
                        <p class="text-gray-400">Masuk ke akun Anda</p>
                    </div>
                    <form id="loginForm" onsubmit="handleLogin(event)">
                        <div class="mb-4">
                            <label class="block text-white text-sm font-bold mb-2">Username</label>
                            <input type="text" id="loginUsername" class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-400 text-white" required>
                        </div>
                        <div class="mb-6">
                            <label class="block text-white text-sm font-bold mb-2">Password</label>
                            <input type="password" id="loginPassword" class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-400 text-white" required>
                        </div>
                        <button type="submit" class="w-full neon-btn py-3">
                            <i class="fas fa-sign-in-alt mr-2"></i>Login
                        </button>
                    </form>
                    <button onclick="hideLogin()" class="mt-4 w-full text-gray-400 hover:text-white transition-colors duration-300">Batal</button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal-backdrop hidden bg-black bg-opacity-50">
        <div class="modal-container">
            <div class="modal-content modern-card max-w-4xl w-full transform transition-all duration-300 scale-95 opacity-0" id="registerModalContent">
            <button onclick="hideRegister()" class="absolute top-3 right-3 w-8 h-8 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white transition-all duration-300 z-10">
                <i class="fas fa-times text-sm"></i>
            </button>
            <div class="p-4 sm:p-6 lg:p-8">
                <!-- Header -->
                <div class="text-center mb-8">
                    <div class="w-20 h-20 mx-auto bg-gradient-to-r from-pink-500 to-red-500 rounded-2xl flex items-center justify-center mb-6 shadow-2xl">
                        <i class="fas fa-user-plus text-3xl text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">
                        <span class="holographic">Formulir Pendaftaran Siswa</span>
                    </h2>
                    <p class="text-gray-400 text-lg">Bergabunglah dengan MLS - SMKS Muhammadiyah 1 Genteng</p>
                    <div class="w-24 h-1 bg-gradient-to-r from-pink-400 to-red-600 mx-auto rounded-full mt-4"></div>
                </div>

                <!-- Progress Indicator -->
                <div class="mb-8">
                    <div class="flex items-center justify-center space-x-4">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                <i class="fas fa-user text-white text-sm"></i>
                            </div>
                            <span class="ml-2 text-white font-medium">Data Pribadi</span>
                        </div>
                        <div class="w-16 h-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full"></div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-teal-600 rounded-full flex items-center justify-center">
                                <i class="fas fa-graduation-cap text-white text-sm"></i>
                            </div>
                            <span class="ml-2 text-white font-medium">Data Akademik</span>
                        </div>
                        <div class="w-16 h-1 bg-gradient-to-r from-green-500 to-teal-600 rounded-full"></div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gradient-to-r from-orange-500 to-red-600 rounded-full flex items-center justify-center">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            <span class="ml-2 text-white font-medium">Konfirmasi</span>
                        </div>
                    </div>
                </div>

                <form id="registerForm" onsubmit="handleRegister(event)">
                    <!-- Data Pribadi Section -->
                    <div class="glass-dark rounded-2xl p-6 mb-6">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-user text-white text-lg"></i>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold text-white">Data Pribadi</h3>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-user mr-2 text-blue-400 text-base"></i>Nama Lengkap *
                                </label>
                                <input type="text" id="namaLengkap" placeholder="Masukkan nama lengkap Anda" 
                                       class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50 text-white placeholder-gray-400 transition-all duration-300 text-base min-h-[52px]" required>
                                <p class="text-xs text-gray-500">Nama sesuai dengan dokumen resmi</p>
                            </div>
                            
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-id-card mr-2 text-purple-400 text-base"></i>NISN *
                                </label>
                                <input type="text" id="nisn" placeholder="10 digit NISN" maxlength="10" pattern="[0-9]{10}"
                                       class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-400 focus:ring-opacity-50 text-white placeholder-gray-400 transition-all duration-300 text-base min-h-[52px]" required>
                                <p class="text-xs text-gray-500">Nomor Induk Siswa Nasional (10 digit)</p>
                            </div>
                            
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-envelope mr-2 text-green-400 text-base"></i>Email *
                                </label>
                                <input type="email" id="email" placeholder="nama@email.com"
                                       class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-400 focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 text-white placeholder-gray-400 transition-all duration-300 text-base min-h-[52px]" required>
                                <p class="text-xs text-gray-500">Email aktif untuk komunikasi</p>
                            </div>
                            
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-phone mr-2 text-teal-400 text-base"></i>No. Telepon *
                                </label>
                                <input type="tel" id="telepon" placeholder="08xxxxxxxxxx" pattern="[0-9]{10,13}"
                                       class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-teal-400 focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 text-white placeholder-gray-400 transition-all duration-300 text-base min-h-[52px]" required>
                                <p class="text-xs text-gray-500">Nomor WhatsApp yang aktif</p>
                            </div>
                        </div>
                        
                        <div class="mt-4 md:mt-6 space-y-2">
                            <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                <i class="fas fa-map-marker-alt mr-2 text-orange-400 text-base"></i>Alamat Lengkap *
                            </label>
                            <textarea id="alamat" rows="3" placeholder="Jalan, RT/RW, Kelurahan, Kecamatan, Kabupaten/Kota, Provinsi"
                                      class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-orange-400 focus:ring-2 focus:ring-orange-400 focus:ring-opacity-50 text-white placeholder-gray-400 transition-all duration-300 resize-none text-base min-h-[100px]" required></textarea>
                            <p class="text-xs text-gray-500">Alamat tempat tinggal saat ini</p>
                        </div>
                    </div>

                    <!-- Data Akademik Section -->
                    <div class="glass-dark rounded-2xl p-6 mb-6">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-600 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-graduation-cap text-white text-lg"></i>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold text-white">Data Akademik</h3>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-layer-group mr-2 text-green-400 text-base"></i>Kelas *
                                </label>
                                <select id="kelas" class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-400 focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 text-white transition-all duration-300 text-base min-h-[52px]" required>
                                    <option value="" class="bg-gray-800">Pilih Kelas</option>
                                    <option value="X" class="bg-gray-800">Kelas X (Sepuluh)</option>
                                    <option value="XI" class="bg-gray-800">Kelas XI (Sebelas)</option>
                                    <option value="XII" class="bg-gray-800">Kelas XII (Dua Belas)</option>
                                </select>
                                <p class="text-xs text-gray-500">Kelas yang akan dimasuki</p>
                            </div>
                            
                            <div class="space-y-2">
                                <label class="block text-white text-sm md:text-sm font-bold flex items-center">
                                    <i class="fas fa-code mr-2 text-teal-400 text-base"></i>Program Keahlian *
                                </label>
                                <select id="jurusan" class="w-full px-4 py-4 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-teal-400 focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 text-white transition-all duration-300 text-base min-h-[52px]" required>
                                    <option value="" class="bg-gray-800">Pilih Program Keahlian</option>
                                    <option value="RPL" class="bg-gray-800"> RPL - Rekayasa Perangkat Lunak</option>
                                    <option value="TKJ" class="bg-gray-800"> TKJ - Teknik Komputer & Jaringan</option>
                                </select>
                                <p class="text-xs text-gray-500">Pilih sesuai minat dan bakat Anda</p>
                            </div>
                        </div>

                        <!-- Program Info Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 mt-4 md:mt-6">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-3 md:p-4 opacity-75 hover:opacity-100 transition-opacity duration-300">
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-code text-white text-lg md:text-xl mr-2 md:mr-3"></i>
                                    <h4 class="font-bold text-white text-sm md:text-base">RPL</h4>
                                </div>
                                <p class="text-blue-100 text-xs md:text-sm">Belajar pemrograman, web development, mobile app, dan software engineering</p>
                            </div>
                            
                            <div class="bg-gradient-to-r from-green-500 to-teal-600 rounded-xl p-3 md:p-4 opacity-75 hover:opacity-100 transition-opacity duration-300">
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-network-wired text-white text-lg md:text-xl mr-2 md:mr-3"></i>
                                    <h4 class="font-bold text-white text-sm md:text-base">TKJ</h4>
                                </div>
                                <p class="text-green-100 text-xs md:text-sm">Belajar jaringan komputer, sistem administrasi, dan teknologi infrastruktur IT</p>
                            </div>
                        </div>
                    </div>

                    <!-- Konfirmasi Section -->
                    <div class="glass-dark rounded-2xl p-6 mb-6">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-red-600 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-check text-white text-lg"></i>
                            </div>
                            <h3 class="text-lg md:text-xl font-bold text-white">Konfirmasi & Persetujuan</h3>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-yellow-500 bg-opacity-20 border border-yellow-500 border-opacity-50 rounded-lg p-4">
                                <div class="flex items-start">
                                    <i class="fas fa-info-circle text-yellow-400 mr-3 mt-1"></i>
                                    <div>
                                        <h4 class="font-bold text-yellow-300 mb-2">Informasi Penting</h4>
                                        <ul class="text-yellow-100 text-sm space-y-1">
                                            <li> Data yang Anda masukkan akan disimpan dengan aman</li>
                                            <li> Pastikan semua informasi yang diisi sudah benar</li>
                                            <li> Anda akan mendapat konfirmasi melalui email</li>
                                            <li> Tim admin akan menghubungi Anda untuk proses selanjutnya</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3">
                                <input type="checkbox" id="agreement" class="mt-1 w-5 h-5 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 focus:ring-2" required>
                                <label for="agreement" class="text-white text-sm leading-relaxed">
                                    Saya menyatakan bahwa data yang saya isi adalah <strong>benar dan dapat dipertanggungjawabkan</strong>. 
                                    Saya setuju dengan <span class="text-blue-400 hover:text-blue-300 cursor-pointer">syarat dan ketentuan</span> 
                                    yang berlaku di MLS - SMKS Muhammadiyah 1 Genteng.
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button type="button" onclick="hideRegister()" 
                                class="flex-1 px-6 py-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-all duration-300 flex items-center justify-center text-base min-h-[56px]">
                            <i class="fas fa-times mr-2 text-lg"></i>Batal
                        </button>
                        <button type="submit" 
                                class="flex-1 px-6 py-4 bg-gradient-to-r from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600 text-white rounded-lg font-bold text-base transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-2xl flex items-center justify-center min-h-[56px]">
                            <i class="fas fa-user-plus mr-3 text-lg"></i>Daftar Sekarang
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>

    <!-- Ultra Modern Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <div class="dashboard-bg">
            <!-- Optimized Background Effects - Desktop Only -->
            <div class="hidden lg:block cyber-grid opacity-20"></div>
            
            <!-- Optimized Admin Header -->
            <nav class="modern-nav relative z-10">
                <div class="hidden lg:block cyber-scan"></div>
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-between h-20">
                        <div class="flex items-center">
                            <div class="relative">
                                <div class="hidden lg:block pulse-ring w-12 h-12"></div>
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center shadow-lg relative z-10">
                                    <i class="fas fa-tachometer-alt text-white text-xl"></i>
                                </div>
                            </div>
                            <div class="ml-4">
                                <h1 class="text-xl lg:text-2xl font-bold">
                                    <span class="holographic">DASHBOARD ADMIN</span>
                                </h1>
                                <p class="text-xs text-gray-400 font-medium hidden sm:block">MLS - SMKS Muhammadiyah 1 Genteng</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2 lg:space-x-4">
                            <div class="glass px-3 py-2 rounded-full hidden md:block">
                                <span class="text-white font-medium text-sm">Selamat datang, Admin</span>
                            </div>
                            <button onclick="logout()" class="action-btn bg-gradient-to-r from-red-500 to-pink-600 text-white px-4 lg:px-6 py-2 lg:py-3 rounded-full font-bold hover:from-red-600 hover:to-pink-700 transition-all duration-300">
                                <i class="fas fa-sign-out-alt mr-1 lg:mr-2 relative z-10"></i>
                                <span class="relative z-10 hidden sm:inline">Logout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 relative z-10">
                <!-- Optimized Stats Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6 lg:mb-8">
                    <div class="stat-card p-4 lg:p-6 relative overflow-hidden">
                        <div class="hidden lg:block cyber-scan"></div>
                        <div class="flex items-center relative z-10">
                            <div class="relative">
                                <div class="hidden lg:block pulse-ring w-12 h-12"></div>
                                <div class="w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center relative z-10">
                                    <i class="fas fa-users text-white text-lg lg:text-xl"></i>
                                </div>
                            </div>
                            <div class="ml-3 lg:ml-4">
                                <p class="text-gray-400 text-xs lg:text-sm font-medium uppercase tracking-wider">Total Siswa</p>
                                <p class="text-xl sm:text-2xl lg:text-3xl font-bold">
                                    <span class="holographic" id="totalSiswa">0</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card p-4 lg:p-6 relative overflow-hidden">
                        <div class="hidden lg:block cyber-scan" style="animation-delay: 1s;"></div>
                        <div class="flex items-center relative z-10">
                            <div class="relative">
                                <div class="hidden lg:block pulse-ring w-12 h-12" style="animation-delay: 0.5s;"></div>
                                <div class="w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center relative z-10">
                                    <i class="fas fa-code text-white text-lg lg:text-xl"></i>
                                </div>
                            </div>
                            <div class="ml-3 lg:ml-4">
                                <p class="text-gray-400 text-xs lg:text-sm font-medium uppercase tracking-wider">Siswa RPL</p>
                                <p class="text-xl sm:text-2xl lg:text-3xl font-bold">
                                    <span class="holographic" id="siswaRPL">0</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card p-4 lg:p-6 relative overflow-hidden">
                        <div class="hidden lg:block cyber-scan" style="animation-delay: 2s;"></div>
                        <div class="flex items-center relative z-10">
                            <div class="relative">
                                <div class="hidden lg:block pulse-ring w-12 h-12" style="animation-delay: 1s;"></div>
                                <div class="w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center relative z-10">
                                    <i class="fas fa-network-wired text-white text-lg lg:text-xl"></i>
                                </div>
                            </div>
                            <div class="ml-3 lg:ml-4">
                                <p class="text-gray-400 text-xs lg:text-sm font-medium uppercase tracking-wider">Siswa TKJ</p>
                                <p class="text-xl sm:text-2xl lg:text-3xl font-bold">
                                    <span class="holographic" id="siswaTKJ">0</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card p-4 lg:p-6 relative overflow-hidden col-span-1 sm:col-span-2 lg:col-span-1">
                        <div class="hidden lg:block cyber-scan" style="animation-delay: 3s;"></div>
                        <div class="flex items-center relative z-10">
                            <div class="relative">
                                <div class="hidden lg:block pulse-ring w-12 h-12" style="animation-delay: 1.5s;"></div>
                                <div class="w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-full flex items-center justify-center relative z-10">
                                    <i class="fas fa-calendar text-white text-lg lg:text-xl"></i>
                                </div>
                            </div>
                            <div class="ml-3 lg:ml-4">
                                <p class="text-gray-400 text-xs lg:text-sm font-medium uppercase tracking-wider">Hari Ini</p>
                                <p class="text-sm sm:text-base lg:text-lg font-bold text-white" id="todayDate"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ultra Modern Action Buttons -->
                <div class="modern-card p-6 sm:p-8 mb-6 sm:mb-8 relative overflow-hidden">
                    <div class="cyber-scan"></div>
                    <h3 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 relative z-10">
                        <span class="holographic">AKSI CEPAT</span>
                    </h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6 mb-4 sm:mb-6 relative z-10">
                        <button onclick="exportToExcel()" class="action-btn bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-2xl font-bold text-base sm:text-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex items-center justify-center">
                            <i class="fas fa-file-excel mr-2 sm:mr-3 text-lg sm:text-2xl relative z-10"></i>
                            <span class="relative z-10">Export ke Excel</span>
                        </button>
                        <button onclick="refreshData()" class="action-btn bg-gradient-to-r from-blue-500 to-cyan-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-2xl font-bold text-base sm:text-lg hover:from-blue-600 hover:to-cyan-700 transition-all duration-300 flex items-center justify-center">
                            <i class="fas fa-sync-alt mr-2 sm:mr-3 text-lg sm:text-2xl relative z-10"></i>
                            <span class="relative z-10">Refresh Data</span>
                        </button>
                        <button onclick="viewReports()" class="action-btn bg-gradient-to-r from-purple-500 to-pink-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-2xl font-bold text-base sm:text-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-300 flex items-center justify-center sm:col-span-2 md:col-span-1">
                            <i class="fas fa-chart-bar mr-2 sm:mr-3 text-lg sm:text-2xl relative z-10"></i>
                            <span class="relative z-10">Lihat Laporan</span>
                        </button>
                    </div>
                    
                    <!-- Database Management Section -->
                    <div class="border-t border-gray-700 pt-6 relative z-10">
                        <h4 class="text-lg font-bold mb-4 text-gray-300">
                            <i class="fas fa-database mr-2"></i>Manajemen Database
                        </h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4">
                            <button onclick="backupDatabase()" class="action-btn bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-medium hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 flex items-center justify-center text-sm sm:text-base">
                                <i class="fas fa-download mr-1 sm:mr-2 relative z-10"></i>
                                <span class="relative z-10">Backup Database</span>
                            </button>
                            <button onclick="restoreDatabase()" class="action-btn bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-medium hover:from-orange-600 hover:to-red-700 transition-all duration-300 flex items-center justify-center text-sm sm:text-base">
                                <i class="fas fa-upload mr-1 sm:mr-2 relative z-10"></i>
                                <span class="relative z-10">Restore Database</span>
                            </button>
                            <button onclick="clearDatabase()" class="action-btn bg-gradient-to-r from-red-500 to-pink-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-medium hover:from-red-600 hover:to-pink-700 transition-all duration-300 flex items-center justify-center text-sm sm:text-base sm:col-span-2 md:col-span-1">
                                <i class="fas fa-trash mr-1 sm:mr-2 relative z-10"></i>
                                <span class="relative z-10">Clear Database</span>
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-3 text-center">
                            <i class="fas fa-info-circle mr-1"></i>
                            Database: <span id="dbStatus" class="font-mono">Loading...</span> | 
                            Status: <span id="dbConnection" class="font-mono">Connecting...</span>
                        </p>
                    </div>
                </div>

                <!-- Notification Area -->
                <div id="notificationArea" class="fixed top-24 right-4 z-50 space-y-2"></div>

                <!-- Ultra Modern Data Table -->
                <div class="futuristic-table relative overflow-hidden">
                    <div class="cyber-scan"></div>
                    <div class="px-8 py-6 border-b border-gray-700 relative z-10">
                        <h3 class="text-2xl font-bold">
                            <span class="holographic">DATA PENDAFTARAN SISWA</span>
                        </h3>
                        <p class="text-gray-400 mt-2">Sistem manajemen data siswa terintegrasi</p>
                    </div>
                    <div class="overflow-x-auto relative z-10">
                        <table class="min-w-full">
                            <thead>
                                <tr>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">No</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Nama</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">NISN</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Kelas</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Jurusan</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Email</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Telepon</th>
                                    <th class="px-6 py-4 text-left text-xs font-bold uppercase tracking-wider">Tanggal Daftar</th>
                                </tr>
                            </thead>
                            <tbody id="studentTableBody" class="text-white">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- About Modal -->
    <div id="aboutModal" class="modal-backdrop hidden bg-black bg-opacity-80">
        <div class="modal-container">
            <div class="modal-content modern-card max-w-4xl w-full transform transition-all duration-300 scale-95 opacity-0" id="aboutModalContent">
            <button onclick="hideAbout()" class="absolute top-3 right-3 w-8 h-8 bg-gray-800 hover:bg-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white transition-all duration-300 z-10">
                <i class="fas fa-times text-sm"></i>
            </button>
            <div class="p-4 sm:p-6 lg:p-8">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 mx-auto bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mb-6 shadow-2xl">
                        <img src="images/LOGO BARU SMK MUHI.png">
                    </div>
                    <h2 class="text-4xl font-bold mb-4">
                        <span class="holographic">Tentang Kami</span>
                    </h2>
                    <div class="w-24 h-1 bg-gradient-to-r from-blue-400 to-purple-600 mx-auto rounded-full mb-8"></div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <div class="glass-dark rounded-2xl p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-graduation-cap text-white text-xl"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white">Visi Kami</h3>
                        </div>
                        <p class="text-gray-300 leading-relaxed">
                            Menjadi platform pembelajaran digital terdepan yang menghasilkan lulusan berkualitas tinggi di bidang teknologi informasi dan komunikasi.
                        </p>
                    </div>
                    
                    <div class="glass-dark rounded-2xl p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-target text-white text-xl"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white">Misi Kami</h3>
                        </div>
                        <p class="text-gray-300 leading-relaxed">
                            Memberikan pendidikan berkualitas dengan teknologi terdepan untuk mempersiapkan siswa menghadapi tantangan era digital.
                        </p>
                    </div>
                </div>
                
                <div class="glass-dark rounded-2xl p-6 mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-center">
                        <span class="holographic">Program Keahlian</span>
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="flex items-center p-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl">
                            <i class="fas fa-code text-2xl text-white mr-4"></i>
                            <div>
                                <h4 class="font-bold text-white">Rekayasa Perangkat Lunak</h4>
                                <p class="text-blue-100 text-sm">Pemrograman & Pengembangan Aplikasi</p>
                            </div>
                        </div>
                        <div class="flex items-center p-4 bg-gradient-to-r from-green-500 to-teal-600 rounded-xl">
                            <i class="fas fa-network-wired text-2xl text-white mr-4"></i>
                            <div>
                                <h4 class="font-bold text-white">Teknik Komputer & Jaringan</h4>
                                <p class="text-green-100 text-sm">Jaringan & Sistem Komputer</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="glass-dark rounded-2xl p-6 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4 text-center">Fitur Platform MLS</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-laptop-code text-white"></i>
                            </div>
                            <h4 class="font-semibold text-white mb-2">Modul Interaktif</h4>
                            <p class="text-gray-400 text-sm">Pembelajaran dengan modul yang interaktif dan mudah dipahami</p>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-chart-line text-white"></i>
                            </div>
                            <h4 class="font-semibold text-white mb-2">Progress Tracking</h4>
                            <p class="text-gray-400 text-sm">Pantau perkembangan belajar secara real-time</p>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-certificate text-white"></i>
                            </div>
                            <h4 class="font-semibold text-white mb-2">Sertifikat Digital</h4>
                            <p class="text-gray-400 text-sm">Dapatkan sertifikat setelah menyelesaikan modul</p>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="hideAbout()" class="neon-btn px-8 py-3">
                        <i class="fas fa-times mr-2"></i>Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Ultra Modern Footer -->
    <footer class="ultra-modern-bg text-white py-16 relative overflow-hidden">
        <!-- Cyber Grid Background -->
        <div class="cyber-grid absolute inset-0 opacity-10"></div>
        
        <!-- Optimized Effects - Desktop Only -->
        <div class="hidden lg:block">
            <!-- Floating Shapes -->
            <div class="absolute inset-0 pointer-events-none">
                <div class="absolute top-10 left-10 w-12 h-12 glass rounded-2xl" style="animation: float-simple 6s ease-in-out infinite;"></div>
                <div class="absolute top-20 right-20 w-8 h-8 glass rounded-full" style="animation: float-simple 6s ease-in-out infinite; animation-delay: 3s;"></div>
                <div class="absolute bottom-20 left-1/4 w-16 h-16 glass rounded-3xl" style="animation: float-simple 6s ease-in-out infinite; animation-delay: 1.5s;"></div>
            </div>
        </div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="grid lg:grid-cols-3 gap-12">
                <!-- School Info -->
                <div class="scroll-reveal">
                    <div class="flex items-center mb-6">
                        <div class="w-16 h-16 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center mr-4 shadow-2xl">
                            <img src="images/LOGO BARU SMK MUHI.png">
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">
                                <span class="holographic">MLS</span>
                            </h3>
                            <p class="text-gray-300 font-medium">SMKS Muhammadiyah 1 Genteng</p>
                        </div>
                    </div>
                    <p class="text-gray-300 leading-relaxed mb-6">
                        Platform pembelajaran digital masa depan untuk siswa jurusan RPL dan TKJ dengan teknologi terdepan dan inovasi berkelanjutan.
                    </p>
                    <div class="flex space-x-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 cursor-pointer">
                            <i class="fab fa-facebook-f text-white"></i>
                        </div>
                        <div class="w-10 h-10 bg-gradient-to-r from-pink-500 to-red-500 rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 cursor-pointer">
                            <i class="fab fa-instagram text-white"></i>
                        </div>
                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 cursor-pointer">
                            <i class="fab fa-whatsapp text-white"></i>
                        </div>
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 cursor-pointer">
                            <i class="fab fa-youtube text-white"></i>
                        </div>
                    </div>
                </div>

                <!-- Location Info -->
                <div class="scroll-reveal" style="animation-delay: 0.2s;">
                    <div class="modern-card p-6 h-full">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-map-marker-alt text-white text-xl"></i>
                            </div>
                            <h3 class="text-xl font-bold">
                                <span class="holographic">Lokasi Sekolah</span>
                            </h3>
                        </div>
                        <div class="space-y-3">
                            <div class="flex items-start">
                                <i class="fas fa-building text-blue-400 mr-3 mt-1"></i>
                                <div>
                                    <p class="font-semibold text-white">SMKS Muhammadiyah 1 Genteng</p>
                                    <p class="text-gray-300 text-sm">Sekolah Menengah Kejuruan</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fas fa-map-pin text-green-400 mr-3 mt-1"></i>
                                <div>
                                    <p class="text-gray-300 leading-relaxed">
                                        Jl. KH Imam Bahri No.10, Dusun Krajan,<br>
                                        Genteng Wetan, Kec. Genteng,<br>
                                        Kabupaten Banyuwangi, Jawa Timur 68465
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-center pt-3">
                                <button class="action-btn bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-4 py-2 rounded-full font-medium hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 flex items-center text-sm">
                                    <i class="fas fa-directions mr-2 relative z-10"></i>
                                    <span class="relative z-10">Lihat di Maps</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="scroll-reveal" style="animation-delay: 0.4s;">
                    <div class="modern-card p-6 h-full">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-link text-white text-xl"></i>
                            </div>
                            <h3 class="text-xl font-bold">
                                <span class="holographic">Quick Links</span>
                            </h3>
                        </div>
                        <div class="space-y-3">
                            <a href="#" onclick="showAbout()" class="flex items-center text-gray-300 hover:text-white transition-colors duration-300 group">
                                <i class="fas fa-chevron-right text-blue-400 mr-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                                <span>Tentang Kami</span>
                            </a>
                            <a href="#" onclick="showRegister()" class="flex items-center text-gray-300 hover:text-white transition-colors duration-300 group">
                                <i class="fas fa-chevron-right text-green-400 mr-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                                <span>Pendaftaran Siswa</span>
                            </a>
                            <a href="#" onclick="selectJurusan('RPL')" class="flex items-center text-gray-300 hover:text-white transition-colors duration-300 group">
                                <i class="fas fa-chevron-right text-purple-400 mr-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                                <span>Program RPL</span>
                            </a>
                            <a href="#" onclick="selectJurusan('TKJ')" class="flex items-center text-gray-300 hover:text-white transition-colors duration-300 group">
                                <i class="fas fa-chevron-right text-teal-400 mr-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                                <span>Program TKJ</span>
                            </a>
                            <a href="#" onclick="accessDashboard()" class="flex items-center text-gray-300 hover:text-white transition-colors duration-300 group">
                                <i class="fas fa-chevron-right text-orange-400 mr-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                                <span>Dashboard Admin</span>
                            </a>
                        </div>
                        
                        <!-- Contact Info -->
                        <div class="mt-8 pt-6 border-t border-gray-700">
                            <h4 class="font-bold text-white mb-3">
                                <i class="fas fa-phone mr-2 text-green-400"></i>Kontak
                            </h4>
                            <div class="space-y-2 text-sm">
                                <p class="text-gray-300">
                                    <i class="fas fa-envelope mr-2 text-blue-400"></i>
                                    info@smkmuh1genteng.sch.id
                                </p>
                                <p class="text-gray-300">
                                    <i class="fas fa-phone mr-2 text-green-400"></i>
                                    (0333) 123-4567
                                </p>
                                <p class="text-gray-300">
                                    <i class="fab fa-whatsapp mr-2 text-green-500"></i>
                                    +62 812-3456-7890
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="border-t border-gray-700 mt-12 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-center md:text-left mb-4 md:mb-0">
                        <p class="text-gray-400 text-sm">
                             2024 <span class="holographic font-semibold">MLS - SMKS Muhammadiyah 1 Genteng</span>. 
                            All rights reserved.
                        </p>
                        <p class="text-gray-500 text-xs mt-1">
                            Powered by Modern Learning System Technology
                        </p>
                    </div>
                    <div class="flex items-center space-x-6 text-sm">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                            <i class="fas fa-shield-alt mr-1"></i>Privacy Policy
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                            <i class="fas fa-file-contract mr-1"></i>Terms of Service
                        </a>
                        <div class="flex items-center text-gray-400">
                            <i class="fas fa-code mr-1"></i>
                            <span>v2.0.1</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- AI Customer Service Chat -->
    <div id="aiChatButton" class="ai-chat-button pulse" onclick="toggleAIChat()">
        <i class="fas fa-robot text-white text-xl"></i>
        <div id="aiNotificationBadge" class="ai-notification-badge" style="display: none;">1</div>
    </div>

    <!-- AI Chat Modal -->
    <div id="aiChatModal" class="ai-chat-modal">
        <div class="ai-chat-container" id="aiChatContainer">
            <div class="ai-chat-header">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-robot text-white text-sm"></i>
                    </div>
                    <div>
                        <h3>AI Customer Service</h3>
                        <div class="text-xs text-blue-100 opacity-75">MLS Assistant - Online</div>
                    </div>
                </div>
                <button class="ai-chat-close" onclick="toggleAIChat()">
                    <i class="fas fa-times text-sm"></i>
                </button>
            </div>
            
            <div id="aiChatMessages" class="ai-chat-messages">
                <!-- Welcome message will be added here -->
            </div>
            
            <div class="ai-chat-input-container">
                <input 
                    type="text" 
                    id="aiChatInput" 
                    class="ai-chat-input" 
                    placeholder="Ketik pertanyaan Anda..."
                    onkeypress="handleAIChatKeyPress(event)"
                    maxlength="500"
                >
                <button id="aiChatSend" class="ai-chat-send" onclick="sendAIMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // ===== DATABASE SIMULATION SYSTEM =====
        class DatabaseManager {
            constructor() {
                this.dbName = 'MLS_Database';
                this.version = 1;
                this.db = null;
                this.isInitialized = false;
                this.initDatabase();
            }

            // Initialize IndexedDB for persistent storage
            async initDatabase() {
                try {
                    return new Promise((resolve, reject) => {
                        const request = indexedDB.open(this.dbName, this.version);
                        
                        request.onerror = () => {
                            console.warn('IndexedDB not available, falling back to localStorage');
                            this.isInitialized = true;
                            resolve();
                        };
                        
                        request.onsuccess = (event) => {
                            this.db = event.target.result;
                            this.isInitialized = true;
                            console.log('Database initialized successfully');
                            resolve();
                        };
                        
                        request.onupgradeneeded = (event) => {
                            const db = event.target.result;
                            
                            // Create students table
                            if (!db.objectStoreNames.contains('students')) {
                                const studentsStore = db.createObjectStore('students', { 
                                    keyPath: 'id', 
                                    autoIncrement: true 
                                });
                                studentsStore.createIndex('nisn', 'nisn', { unique: true });
                                studentsStore.createIndex('email', 'email', { unique: true });
                                studentsStore.createIndex('jurusan', 'jurusan', { unique: false });
                            }
                            
                            // Create users table for authentication
                            if (!db.objectStoreNames.contains('users')) {
                                const usersStore = db.createObjectStore('users', { 
                                    keyPath: 'id', 
                                    autoIncrement: true 
                                });
                                usersStore.createIndex('username', 'username', { unique: true });
                                usersStore.createIndex('email', 'email', { unique: true });
                            }
                            
                            // Create logs table for activity tracking
                            if (!db.objectStoreNames.contains('logs')) {
                                const logsStore = db.createObjectStore('logs', { 
                                    keyPath: 'id', 
                                    autoIncrement: true 
                                });
                                logsStore.createIndex('timestamp', 'timestamp', { unique: false });
                                logsStore.createIndex('action', 'action', { unique: false });
                            }
                        };
                    });
                } catch (error) {
                    console.warn('Database initialization failed, using localStorage:', error);
                    this.isInitialized = true;
                }
            }

            // Generic database operations
            async executeTransaction(storeName, mode, operation) {
                if (!this.db) {
                    // Fallback to localStorage
                    return this.localStorageOperation(storeName, operation);
                }
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([storeName], mode);
                    const store = transaction.objectStore(storeName);
                    
                    transaction.oncomplete = () => resolve();
                    transaction.onerror = () => reject(transaction.error);
                    
                    operation(store, resolve, reject);
                });
            }

            // LocalStorage fallback operations
            localStorageOperation(storeName, operation) {
                const data = JSON.parse(localStorage.getItem(storeName) || '[]');
                const result = operation(data);
                if (result !== undefined) {
                    localStorage.setItem(storeName, JSON.stringify(data));
                }
                return Promise.resolve(result);
            }

            // Add student to database
            async addStudent(studentData) {
                const student = {
                    ...studentData,
                    id: Date.now() + Math.random(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    status: 'active'
                };

                if (!this.db) {
                    return this.localStorageOperation('students', (data) => {
                        // Check for duplicates
                        if (data.some(s => s.nisn === student.nisn)) {
                            throw new Error('NISN sudah terdaftar');
                        }
                        if (data.some(s => s.email === student.email)) {
                            throw new Error('Email sudah terdaftar');
                        }
                        data.push(student);
                        return student;
                    });
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['students'], 'readwrite');
                    const store = transaction.objectStore('students');
                    
                    // Check for NISN duplicate
                    const nisnIndex = store.index('nisn');
                    const nisnRequest = nisnIndex.get(student.nisn);
                    
                    nisnRequest.onsuccess = () => {
                        if (nisnRequest.result) {
                            reject(new Error('NISN sudah terdaftar'));
                            return;
                        }
                        
                        // Check for email duplicate
                        const emailIndex = store.index('email');
                        const emailRequest = emailIndex.get(student.email);
                        
                        emailRequest.onsuccess = () => {
                            if (emailRequest.result) {
                                reject(new Error('Email sudah terdaftar'));
                                return;
                            }
                            
                            // Add student
                            const addRequest = store.add(student);
                            addRequest.onsuccess = () => {
                                this.logActivity('student_registered', `Student ${student.namaLengkap} registered`);
                                resolve(student);
                            };
                            addRequest.onerror = () => reject(addRequest.error);
                        };
                    };
                });
            }

            // Get all students
            async getAllStudents() {
                if (!this.db) {
                    return this.localStorageOperation('students', (data) => data);
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['students'], 'readonly');
                    const store = transaction.objectStore('students');
                    const request = store.getAll();
                    
                    request.onsuccess = () => resolve(request.result || []);
                    request.onerror = () => reject(request.error);
                });
            }

            // Get students by jurusan
            async getStudentsByJurusan(jurusan) {
                if (!this.db) {
                    return this.localStorageOperation('students', (data) => 
                        data.filter(s => s.jurusan === jurusan)
                    );
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['students'], 'readonly');
                    const store = transaction.objectStore('students');
                    const index = store.index('jurusan');
                    const request = index.getAll(jurusan);
                    
                    request.onsuccess = () => resolve(request.result || []);
                    request.onerror = () => reject(request.error);
                });
            }

            // Update student
            async updateStudent(id, updateData) {
                const updatedData = {
                    ...updateData,
                    updatedAt: new Date().toISOString()
                };

                if (!this.db) {
                    return this.localStorageOperation('students', (data) => {
                        const index = data.findIndex(s => s.id === id);
                        if (index !== -1) {
                            data[index] = { ...data[index], ...updatedData };
                            return data[index];
                        }
                        throw new Error('Student not found');
                    });
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['students'], 'readwrite');
                    const store = transaction.objectStore('students');
                    
                    const getRequest = store.get(id);
                    getRequest.onsuccess = () => {
                        const student = getRequest.result;
                        if (!student) {
                            reject(new Error('Student not found'));
                            return;
                        }
                        
                        const updatedStudent = { ...student, ...updatedData };
                        const putRequest = store.put(updatedStudent);
                        
                        putRequest.onsuccess = () => {
                            this.logActivity('student_updated', `Student ${updatedStudent.namaLengkap} updated`);
                            resolve(updatedStudent);
                        };
                        putRequest.onerror = () => reject(putRequest.error);
                    };
                });
            }

            // Delete student
            async deleteStudent(id) {
                if (!this.db) {
                    return this.localStorageOperation('students', (data) => {
                        const index = data.findIndex(s => s.id === id);
                        if (index !== -1) {
                            const deleted = data.splice(index, 1)[0];
                            return deleted;
                        }
                        throw new Error('Student not found');
                    });
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['students'], 'readwrite');
                    const store = transaction.objectStore('students');
                    
                    const getRequest = store.get(id);
                    getRequest.onsuccess = () => {
                        const student = getRequest.result;
                        if (!student) {
                            reject(new Error('Student not found'));
                            return;
                        }
                        
                        const deleteRequest = store.delete(id);
                        deleteRequest.onsuccess = () => {
                            this.logActivity('student_deleted', `Student ${student.namaLengkap} deleted`);
                            resolve(student);
                        };
                        deleteRequest.onerror = () => reject(deleteRequest.error);
                    };
                });
            }

            // Log activity
            async logActivity(action, description, userId = null) {
                const logEntry = {
                    action,
                    description,
                    userId,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    ip: 'localhost' // In real app, get from server
                };

                if (!this.db) {
                    return this.localStorageOperation('logs', (data) => {
                        data.push(logEntry);
                        // Keep only last 1000 logs
                        if (data.length > 1000) {
                            data.splice(0, data.length - 1000);
                        }
                        return logEntry;
                    });
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['logs'], 'readwrite');
                    const store = transaction.objectStore('logs');
                    const request = store.add(logEntry);
                    
                    request.onsuccess = () => resolve(logEntry);
                    request.onerror = () => reject(request.error);
                });
            }

            // Get activity logs
            async getActivityLogs(limit = 100) {
                if (!this.db) {
                    return this.localStorageOperation('logs', (data) => 
                        data.slice(-limit).reverse()
                    );
                }

                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction(['logs'], 'readonly');
                    const store = transaction.objectStore('logs');
                    const index = store.index('timestamp');
                    const request = index.openCursor(null, 'prev');
                    
                    const logs = [];
                    let count = 0;
                    
                    request.onsuccess = (event) => {
                        const cursor = event.target.result;
                        if (cursor && count < limit) {
                            logs.push(cursor.value);
                            count++;
                            cursor.continue();
                        } else {
                            resolve(logs);
                        }
                    };
                    
                    request.onerror = () => reject(request.error);
                });
            }

            // Database statistics
            async getStatistics() {
                const students = await this.getAllStudents();
                const logs = await this.getActivityLogs(50);
                
                return {
                    totalStudents: students.length,
                    studentsRPL: students.filter(s => s.jurusan === 'RPL').length,
                    studentsTKJ: students.filter(s => s.jurusan === 'TKJ').length,
                    recentRegistrations: students.filter(s => {
                        const regDate = new Date(s.createdAt);
                        const weekAgo = new Date();
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        return regDate > weekAgo;
                    }).length,
                    recentActivity: logs.slice(0, 10),
                    lastUpdated: new Date().toISOString()
                };
            }

            // Export data for backup
            async exportData() {
                const students = await this.getAllStudents();
                const logs = await this.getActivityLogs(500);
                
                return {
                    students,
                    logs,
                    exportDate: new Date().toISOString(),
                    version: this.version
                };
            }

            // Import data from backup
            async importData(data) {
                if (!data.students || !Array.isArray(data.students)) {
                    throw new Error('Invalid data format');
                }

                // Clear existing data
                if (this.db) {
                    const transaction = this.db.transaction(['students', 'logs'], 'readwrite');
                    await Promise.all([
                        new Promise(resolve => {
                            const request = transaction.objectStore('students').clear();
                            request.onsuccess = () => resolve();
                        }),
                        new Promise(resolve => {
                            const request = transaction.objectStore('logs').clear();
                            request.onsuccess = () => resolve();
                        })
                    ]);
                } else {
                    localStorage.removeItem('students');
                    localStorage.removeItem('logs');
                }

                // Import students
                for (const student of data.students) {
                    await this.addStudent(student);
                }

                // Import logs if available
                if (data.logs && Array.isArray(data.logs)) {
                    for (const log of data.logs) {
                        await this.logActivity(log.action, log.description, log.userId);
                    }
                }

                await this.logActivity('data_imported', `Imported ${data.students.length} students`);
                return { success: true, imported: data.students.length };
            }
        }

        // Initialize database
        const db = new DatabaseManager();

        // ===== AI CUSTOMER SERVICE SYSTEM =====
        class AICustomerService {
            constructor() {
                this.apiKey = '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'; // Replace with your actual Groq API key
                this.apiUrl = 'https://api.groq.com/openai/v1/chat/completions';
                this.model = 'openai/gpt-oss-120b'; // Groq's Llama model
                this.isOpen = false;
                this.messages = [{
                "role": "system",
                "content": "kamu adalah seorang customer service yang sangat ahli dibidang rekayasa perangkat lunak dan teknik komputer dan jaringan, dan kamu akan membantu para junior yang sedang ingin mendalami dua bidang ini,."
                 },];
                this.isTyping = false;
                this.initializeChat();
            }

            initializeChat() {
                // Add welcome message
                this.addMessage('ai', `
                    Halo!  Saya adalah AI Assistant untuk MLS - SMKS Muhammadiyah 1 Genteng.
                    
                    Saya siap membantu Anda dengan:
                     Informasi tentang program RPL dan TKJ
                     Proses pendaftaran siswa
                     Fasilitas dan kurikulum sekolah
                     Pertanyaan umum lainnya
                    
                    Silakan tanyakan apa saja yang ingin Anda ketahui! 
                `, true);
            }

            async sendMessage(userMessage) {
                if (!userMessage.trim()) return;

                // Add user message
                this.addMessage('user', userMessage);
                
                // Show typing indicator
                this.showTyping();

                try {
                    // Check if API key is properly configured
                    if (!this.apiKey || this.apiKey === 'gsk_YOUR_GROQ_API_KEY_HERE') {
                        throw new Error('API key not configured');
                    }

                    // Prepare context about the school
                    const systemPrompt = `
                        Anda adalah AI Customer Service untuk MLS (Modul Latihan Siswa) - SMKS Muhammadiyah 1 Genteng.
                        
                        INFORMASI SEKOLAH:
                        - Nama: SMKS Muhammadiyah 1 Genteng
                        - Lokasi: Jl. KH Imam Bahri No.10, Dusun Krajan, Genteng Wetan, Kec. Genteng, Kabupaten Banyuwangi, Jawa Timur 68465
                        - Program Keahlian: RPL (Rekayasa Perangkat Lunak) dan TKJ (Teknik Komputer & Jaringan)
                        - Platform: MLS adalah platform pembelajaran digital untuk siswa RPL dan TKJ
                        
                        PROGRAM RPL:
                        - Fokus: Pemrograman, web development, mobile app, software engineering
                        - Modul unggulan: Java Programming
                        - Pembelajaran: Coding, database, UI/UX design
                        
                        PROGRAM TKJ:
                        - Fokus: Jaringan komputer, sistem administrasi, infrastruktur IT
                        - Modul unggulan: Basic IoT
                        - Pembelajaran: Networking, hardware, sistem operasi
                        
                        FITUR PLATFORM MLS:
                        - Modul pembelajaran interaktif
                        - Progress tracking real-time
                        - Sertifikat digital
                        - Dashboard admin untuk monitoring
                        
                        INSTRUKSI:
                        - Jawab dalam bahasa Indonesia yang ramah dan profesional
                        - Berikan informasi akurat tentang sekolah dan program
                        - Jika tidak tahu jawaban spesifik, arahkan untuk menghubungi admin
                        - Gunakan emoji yang sesuai untuk membuat percakapan lebih menarik
                        - Maksimal 200 kata per respons
                        - Jika ditanya tentang pendaftaran, jelaskan proses dan syarat-syaratnya
                    `;

                    const response = await fetch(this.apiUrl, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${this.apiKey}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: this.model,
                            messages: [
                                { role: 'system', content: systemPrompt },
                                { role: 'user', content: userMessage }
                            ],
                            max_tokens: 8192,
                            temperature: 1,
                            stream: false
                        })
                    });

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('API Response Error:', response.status, errorText);
                        throw new Error(`API Error: ${response.status} - ${response.statusText}`);
                    }

                    const data = await response.json();
                    console.log('API Response:', data);
                    
                    const aiResponse = data.choices?.[0]?.message?.content;
                    
                    if (!aiResponse) {
                        console.error('No AI response content:', data);
                        throw new Error('No response content from AI');
                    }
                    
                    // Hide typing and show response
                    this.hideTyping();
                    this.addMessage('ai', aiResponse);

                } catch (error) {
                    console.error('AI API Error:', error);
                    this.hideTyping();
                    
                    // Show specific error message for API key issues
                    if (error.message.includes('API key') || error.message.includes('401') || error.message.includes('403')) {
                        this.addMessage('ai', `
                             **API Key Error**
                            
                            Sepertinya ada masalah dengan konfigurasi API key Groq. 
                            
                            Untuk menggunakan AI Customer Service:
                            1. Pastikan API key Groq sudah benar
                            2. Periksa quota dan limit API
                            3. Verifikasi koneksi internet
                            
                            Sementara itu, saya tetap bisa membantu dengan informasi dasar tentang sekolah! 
                        `);
                    } else {
                        // Fallback response with school information
                        const fallbackResponse = this.getFallbackResponse(userMessage);
                        this.addMessage('ai', fallbackResponse);
                    }
                }
            }

            getFallbackResponse(userMessage) {
                const message = userMessage.toLowerCase();
                
                if (message.includes('rpl') || message.includes('rekayasa perangkat lunak') || message.includes('programming')) {
                    return `
                         **Program RPL (Rekayasa Perangkat Lunak)**
                        
                        Program RPL di SMKS Muhammadiyah 1 Genteng fokus pada:
                         Pemrograman (Java, Python, Web Development)
                         Database Management
                         Mobile App Development
                         Software Engineering
                        
                        Modul unggulan: **Java Programming** dengan progress tracking 80%
                        
                        Lulusan RPL siap bekerja sebagai programmer, web developer, atau software engineer! 
                    `;
                }
                
                if (message.includes('tkj') || message.includes('teknik komputer') || message.includes('jaringan')) {
                    return `
                         **Program TKJ (Teknik Komputer & Jaringan)**
                        
                        Program TKJ di SMKS Muhammadiyah 1 Genteng fokus pada:
                         Jaringan Komputer & Internet
                         Sistem Administrasi Server
                         Hardware & Troubleshooting
                         Basic IoT (Internet of Things)
                        
                        Modul unggulan: **Basic IoT** dengan teknologi terdepan
                        
                        Lulusan TKJ siap bekerja sebagai network administrator, IT support, atau IoT specialist! 
                    `;
                }
                
                if (message.includes('daftar') || message.includes('pendaftaran') || message.includes('registrasi')) {
                    return `
                         **Pendaftaran Siswa MLS**
                        
                        Untuk mendaftar, Anda perlu:
                         Nama lengkap
                         NISN (10 digit)
                         Email aktif
                         Nomor telepon/WhatsApp
                         Alamat lengkap
                         Pilih kelas (X, XI, XII)
                         Pilih jurusan (RPL/TKJ)
                        
                        Klik tombol **"Daftar Sekarang"** di website untuk memulai pendaftaran! 
                        
                        Tim admin akan menghubungi Anda setelah pendaftaran berhasil. 
                    `;
                }
                
                if (message.includes('lokasi') || message.includes('alamat') || message.includes('dimana')) {
                    return `
                         **Lokasi SMKS Muhammadiyah 1 Genteng**
                        
                        Alamat: Jl. KH Imam Bahri No.10, Dusun Krajan, Genteng Wetan, Kec. Genteng, Kabupaten Banyuwangi, Jawa Timur 68465
                        
                         Kontak:
                         Email: info@smkmuh1genteng.sch.id
                         Telepon: (0333) 123-4567
                         WhatsApp: +62 812-3456-7890
                        
                        Sekolah mudah dijangkau dan memiliki fasilitas lengkap untuk pembelajaran teknologi! 
                    `;
                }
                
                if (message.includes('fasilitas') || message.includes('lab') || message.includes('ruang')) {
                    return `
                         **Fasilitas SMKS Muhammadiyah 1 Genteng**
                        
                         Lab Komputer dengan PC terbaru
                         Lab Jaringan untuk praktik TKJ
                         Lab Programming untuk RPL
                         Ruang kelas ber-AC
                         Perpustakaan digital
                         WiFi high-speed di seluruh area
                         Kantin dan area istirahat
                        
                        Platform MLS juga menyediakan:
                         Modul pembelajaran interaktif 
                         Progress tracking real-time 
                         Sertifikat digital 
                    `;
                }
                
                // Default response
                return `
                    Terima kasih atas pertanyaan Anda! 
                    
                    Saya adalah AI Assistant untuk MLS - SMKS Muhammadiyah 1 Genteng. Saya dapat membantu dengan informasi tentang:
                    
                     Program RPL dan TKJ
                     Proses pendaftaran
                     Fasilitas sekolah
                     Lokasi dan kontak
                    
                    Untuk informasi lebih detail, silakan hubungi admin atau gunakan tombol **"Login"** untuk mengakses dashboard.
                    
                    Ada yang bisa saya bantu lagi? 
                `;
            }

            addMessage(sender, content, isWelcome = false) {
                const messagesContainer = document.getElementById('aiChatMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `ai-message ${sender}`;
                
                const avatar = document.createElement('div');
                avatar.className = `ai-message-avatar ${sender}`;
                avatar.innerHTML = sender === 'ai' ? '' : '';
                
                const messageContent = document.createElement('div');
                messageContent.className = 'ai-message-content';
                messageContent.innerHTML = content.replace(/\n/g, '<br>');
                
                messageDiv.appendChild(avatar);
                messageDiv.appendChild(messageContent);
                
                // Add quick actions for welcome message
                if (isWelcome) {
                    const quickActions = document.createElement('div');
                    quickActions.className = 'ai-quick-actions';
                    quickActions.innerHTML = `
                        <button class="ai-quick-action" onclick="aiService.sendMessage('Apa itu program RPL?')">Program RPL</button>
                        <button class="ai-quick-action" onclick="aiService.sendMessage('Apa itu program TKJ?')">Program TKJ</button>
                        <button class="ai-quick-action" onclick="aiService.sendMessage('Bagaimana cara mendaftar?')">Cara Daftar</button>
                        <button class="ai-quick-action" onclick="aiService.sendMessage('Dimana lokasi sekolah?')">Lokasi</button>
                    `;
                    messageContent.appendChild(quickActions);
                }
                
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Store message
                this.messages.push({ sender, content, timestamp: new Date() });
            }

            showTyping() {
                if (this.isTyping) return;
                
                this.isTyping = true;
                const messagesContainer = document.getElementById('aiChatMessages');
                const typingDiv = document.createElement('div');
                typingDiv.id = 'aiTypingIndicator';
                typingDiv.className = 'ai-message ai';
                
                typingDiv.innerHTML = `
                    <div class="ai-message-avatar ai"></div>
                    <div class="ai-message-content">
                        <div class="ai-typing">
                            <span>AI sedang mengetik</span>
                            <div class="ai-typing-dots">
                                <div class="ai-typing-dot"></div>
                                <div class="ai-typing-dot"></div>
                                <div class="ai-typing-dot"></div>
                            </div>
                        </div>
                    </div>
                `;
                
                messagesContainer.appendChild(typingDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            hideTyping() {
                const typingIndicator = document.getElementById('aiTypingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
                this.isTyping = false;
            }

            toggleChat() {
                const modal = document.getElementById('aiChatModal');
                const container = document.getElementById('aiChatContainer');
                const button = document.getElementById('aiChatButton');
                const badge = document.getElementById('aiNotificationBadge');
                
                this.isOpen = !this.isOpen;
                
                if (this.isOpen) {
                    // Show modal at current viewport position
                    modal.style.display = 'flex';
                    
                    // Prevent body scroll but maintain current position
                    const scrollY = window.scrollY;
                    document.body.style.position = 'fixed';
                    document.body.style.top = `-${scrollY}px`;
                    document.body.style.width = '100%';
                    
                    // Store scroll position for restoration
                    modal.dataset.scrollY = scrollY;
                    
                    // Trigger animation
                    setTimeout(() => {
                        container.classList.add('show');
                    }, 10);
                    
                    if (button) {
                        button.classList.remove('pulse');
                    }
                    if (badge) {
                        badge.style.display = 'none';
                    }
                    
                    // Focus input
                    setTimeout(() => {
                        document.getElementById('aiChatInput').focus();
                    }, 300);
                } else {
                    container.classList.remove('show');
                    
                    setTimeout(() => {
                        modal.style.display = 'none';
                        
                        // Restore body scroll position
                        const scrollY = modal.dataset.scrollY;
                        document.body.style.position = '';
                        document.body.style.top = '';
                        document.body.style.width = '';
                        window.scrollTo(0, parseInt(scrollY || '0'));
                    }, 300);
                }
            }

            handleKeyPress(event) {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    this.sendUserMessage();
                }
            }

            sendUserMessage() {
                const input = document.getElementById('aiChatInput');
                const message = input.value.trim();
                
                if (message && !this.isTyping) {
                    input.value = '';
                    this.sendMessage(message);
                }
            }
        }

        // Initialize AI Service
        const aiService = new AICustomerService();

        // Global functions for AI Chat
        function toggleAIChat() {
            aiService.toggleChat();
        }

        function sendAIMessage() {
            aiService.sendUserMessage();
        }

        function handleAIChatKeyPress(event) {
            aiService.handleKeyPress(event);
        }
        
        // Legacy variables for compatibility
        let students = [];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

        // Load students from database
        async function loadStudentsFromDB() {
            try {
                if (db && db.isInitialized) {
                    students = await db.getAllStudents();
                } else {
                    // Fallback to localStorage
                    students = JSON.parse(localStorage.getItem('students') || '[]');
                }
                console.log(`Loaded ${students.length} students from storage`);
            } catch (error) {
                console.error('Error loading students:', error);
                // Fallback to localStorage
                students = JSON.parse(localStorage.getItem('students') || '[]');
                console.log(`Fallback: Loaded ${students.length} students from localStorage`);
            }
        }

        // Enhanced Modal Functions with Perfect Centering
        function showAbout() {
            const modal = document.getElementById('aboutModal');
            const content = document.getElementById('aboutModalContent');
            
            // Show modal at current viewport position
            modal.classList.remove('hidden');
            
            // Prevent body scroll but maintain current position
            const scrollY = window.scrollY;
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.width = '100%';
            
            // Store scroll position for restoration
            modal.dataset.scrollY = scrollY;
            
            // Trigger animation
            setTimeout(() => {
                content.classList.add('modal-show');
                content.classList.remove('modal-hide');
            }, 10);
        }

        function hideAbout() {
            const modal = document.getElementById('aboutModal');
            const content = document.getElementById('aboutModalContent');
            
            content.classList.add('modal-hide');
            content.classList.remove('modal-show');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                
                // Restore body scroll position
                const scrollY = modal.dataset.scrollY;
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.width = '';
                window.scrollTo(0, parseInt(scrollY || '0'));
            }, 300);
        }

        function showLogin() {
            const modal = document.getElementById('loginModal');
            const content = document.getElementById('loginModalContent');
            
            // Show modal at current viewport position
            modal.classList.remove('hidden');
            
            // Prevent body scroll but maintain current position
            const scrollY = window.scrollY;
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.width = '100%';
            
            // Store scroll position for restoration
            modal.dataset.scrollY = scrollY;
            
            // Trigger animation
            setTimeout(() => {
                content.classList.add('modal-show');
                content.classList.remove('modal-hide');
            }, 10);
        }

        function hideLogin() {
            const modal = document.getElementById('loginModal');
            const content = document.getElementById('loginModalContent');
            
            content.classList.add('modal-hide');
            content.classList.remove('modal-show');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                
                // Restore body scroll position
                const scrollY = modal.dataset.scrollY;
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.width = '';
                window.scrollTo(0, parseInt(scrollY || '0'));
            }, 300);
        }

        function showRegister() {
            const modal = document.getElementById('registerModal');
            const content = document.getElementById('registerModalContent');
            
            // Show modal at current viewport position
            modal.classList.remove('hidden');
            
            // Prevent body scroll but maintain current position
            const scrollY = window.scrollY;
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.width = '100%';
            
            // Store scroll position for restoration
            modal.dataset.scrollY = scrollY;
            
            // Trigger animation
            setTimeout(() => {
                content.classList.add('modal-show');
                content.classList.remove('modal-hide');
            }, 10);
        }

        function hideRegister() {
            const modal = document.getElementById('registerModal');
            const content = document.getElementById('registerModalContent');
            
            content.classList.add('modal-hide');
            content.classList.remove('modal-show');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                
                // Restore body scroll position
                const scrollY = modal.dataset.scrollY;
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.width = '';
                window.scrollTo(0, parseInt(scrollY || '0'));
            }, 300);
        }

        function selectJurusan(jurusan) {
            document.getElementById('jurusan').value = jurusan;
            showRegister();
        }

        // Authentication Functions
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (username === 'admin' && password === 'admin123') {
                currentUser = { username: 'admin', role: 'admin', loginTime: new Date().toISOString() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                hideLogin();
                showDashboard();
                showNotification('Login berhasil! Selamat datang Admin.', 'success');
                
                // Reset form
                document.getElementById('loginForm').reset();
            } else {
                showNotification('Username atau password salah!', 'error');
            }
        }

        async function handleRegister(event) {
            event.preventDefault();
            
            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Mendaftar...';
            submitBtn.disabled = true;
            
            try {
                // Get form data
                const formData = {
                    namaLengkap: document.getElementById('namaLengkap').value.trim(),
                    nisn: document.getElementById('nisn').value.trim(),
                    kelas: document.getElementById('kelas').value,
                    jurusan: document.getElementById('jurusan').value,
                    email: document.getElementById('email').value.trim().toLowerCase(),
                    telepon: document.getElementById('telepon').value.trim(),
                    alamat: document.getElementById('alamat').value.trim(),
                    tanggalDaftar: new Date().toLocaleDateString('id-ID')
                };

                // Basic validation
                if (!formData.namaLengkap || formData.namaLengkap.length < 3) {
                    throw new Error('Nama lengkap minimal 3 karakter');
                }
                
                if (!formData.nisn || formData.nisn.length < 8) {
                    throw new Error('NISN harus minimal 8 digit');
                }
                
                if (!/^\d+$/.test(formData.nisn)) {
                    throw new Error('NISN hanya boleh berisi angka');
                }
                
                if (!formData.kelas) {
                    throw new Error('Silakan pilih kelas');
                }
                
                if (!formData.jurusan) {
                    throw new Error('Silakan pilih program keahlian');
                }
                
                if (!formData.email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
                    throw new Error('Format email tidak valid');
                }
                
                if (!formData.telepon || formData.telepon.length < 10) {
                    throw new Error('Nomor telepon minimal 10 digit');
                }
                
                if (!formData.alamat || formData.alamat.length < 10) {
                    throw new Error('Alamat minimal 10 karakter');
                }

                // Check agreement checkbox
                const agreement = document.getElementById('agreement');
                if (!agreement.checked) {
                    throw new Error('Anda harus menyetujui syarat dan ketentuan');
                }

                // Create student object with ID
                const newStudent = {
                    ...formData,
                    id: Date.now() + Math.random(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    status: 'active'
                };

                // Try to use database, fallback to localStorage
                try {
                    if (db && db.isInitialized) {
                        // Check for duplicates in database
                        const existingStudents = await db.getAllStudents();
                        
                        if (existingStudents.some(s => s.nisn === newStudent.nisn)) {
                            throw new Error('NISN sudah terdaftar');
                        }
                        
                        if (existingStudents.some(s => s.email === newStudent.email)) {
                            throw new Error('Email sudah terdaftar');
                        }
                        
                        await db.addStudent(formData);
                        students = await db.getAllStudents();
                    } else {
                        // Fallback to localStorage
                        const existingStudents = JSON.parse(localStorage.getItem('students') || '[]');
                        
                        if (existingStudents.some(s => s.nisn === newStudent.nisn)) {
                            throw new Error('NISN sudah terdaftar');
                        }
                        
                        if (existingStudents.some(s => s.email === newStudent.email)) {
                            throw new Error('Email sudah terdaftar');
                        }
                        
                        existingStudents.push(newStudent);
                        localStorage.setItem('students', JSON.stringify(existingStudents));
                        students = existingStudents;
                    }
                } catch (dbError) {
                    console.warn('Database error, using localStorage:', dbError);
                    
                    // Fallback to localStorage
                    const existingStudents = JSON.parse(localStorage.getItem('students') || '[]');
                    
                    if (existingStudents.some(s => s.nisn === newStudent.nisn)) {
                        throw new Error('NISN sudah terdaftar');
                    }
                    
                    if (existingStudents.some(s => s.email === newStudent.email)) {
                        throw new Error('Email sudah terdaftar');
                    }
                    
                    existingStudents.push(newStudent);
                    localStorage.setItem('students', JSON.stringify(existingStudents));
                    students = existingStudents;
                }
                
                hideRegister();
                
                // Show success notification
                Swal.fire({
                    title: 'Pendaftaran Berhasil! ',
                    html: `
                        <div class="text-left">
                            <p class="mb-2"><strong>Nama:</strong> ${newStudent.namaLengkap}</p>
                            <p class="mb-2"><strong>NISN:</strong> ${newStudent.nisn}</p>
                            <p class="mb-2"><strong>Jurusan:</strong> ${newStudent.jurusan}</p>
                            <p class="mb-2"><strong>Kelas:</strong> ${newStudent.kelas}</p>
                            <p class="mb-2"><strong>ID Siswa:</strong> #${Math.floor(newStudent.id)}</p>
                            <hr class="my-3">
                            <p class="text-sm text-gray-600">Data Anda telah tersimpan dengan aman. Tim admin akan menghubungi Anda segera.</p>
                        </div>
                    `,
                    icon: 'success',
                    background: '#1a1a2e',
                    color: '#ffffff',
                    confirmButtonColor: '#667eea',
                    confirmButtonText: 'Tutup',
                    width: '90%',
                    padding: '1rem',
                    customClass: {
                        popup: 'mobile-swal-popup',
                        title: 'mobile-swal-title',
                        content: 'mobile-swal-content'
                    }
                });
                
                // Reset form
                document.getElementById('registerForm').reset();
                
                // Log successful registration
                console.log('Student registered successfully:', newStudent);
                
                // Try to log activity
                try {
                    if (db && db.isInitialized) {
                        await db.logActivity('student_registered', `Student ${newStudent.namaLengkap} registered successfully`);
                    }
                } catch (logError) {
                    console.warn('Could not log activity:', logError);
                }
                
            } catch (error) {
                console.error('Registration error:', error);
                
                // Show error notification
                Swal.fire({
                    title: 'Pendaftaran Gagal!',
                    text: error.message || 'Terjadi kesalahan saat mendaftar. Silakan coba lagi.',
                    icon: 'error',
                    background: '#1a1a2e',
                    color: '#ffffff',
                    confirmButtonColor: '#d33',
                    confirmButtonText: 'Tutup',
                    width: '90%',
                    padding: '1rem',
                    customClass: {
                        popup: 'mobile-swal-popup',
                        title: 'mobile-swal-title',
                        content: 'mobile-swal-content'
                    }
                });
            } finally {
                // Restore button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        async function logout() {
            const result = await Swal.fire({
                title: 'Konfirmasi Logout',
                text: 'Apakah Anda yakin ingin keluar dari dashboard admin?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#667eea',
                confirmButtonText: 'Ya, Logout!',
                cancelButtonText: 'Batal',
                background: '#1a1a2e',
                color: '#ffffff',
                reverseButtons: true,
                width: '90%',
                padding: '1rem',
                customClass: {
                    popup: 'mobile-swal-popup',
                    title: 'mobile-swal-title',
                    content: 'mobile-swal-content'
                }
            });
            
            if (result.isConfirmed) {
                try {
                    // Log logout activity before clearing user data
                    if (currentUser) {
                        await db.logActivity('admin_logout', `Admin ${currentUser.username} logged out`);
                    }
                    
                    currentUser = null;
                    localStorage.removeItem('currentUser');
                    hideDashboard();
                    
                    // Simple alert for logout confirmation
                    alert('Logout berhasil! Anda telah keluar dari dashboard admin.');
                    
                } catch (error) {
                    console.error('Logout error:', error);
                    // Still proceed with logout even if logging fails
                    currentUser = null;
                    localStorage.removeItem('currentUser');
                    hideDashboard();
                    alert('Logout berhasil! Sampai jumpa lagi.');
                }
            }
        }

        // Dashboard Functions
        function showDashboard() {
            // Check if user is authenticated
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('Akses ditolak! Silakan login terlebih dahulu.', 'error');
                showLogin();
                return;
            }
            
            // Hide all main content sections
            const mainSections = document.querySelectorAll('nav, section');
            mainSections.forEach(section => {
                if (!section.classList.contains('modern-nav') || !section.closest('#adminDashboard')) {
                    section.style.display = 'none';
                }
            });
            
            document.getElementById('adminDashboard').classList.remove('hidden');
            updateDashboardStats();
            loadStudentData();
            updateTodayDate();
        }

        function hideDashboard() {
            // Show all main content sections
            const mainSections = document.querySelectorAll('nav, section');
            mainSections.forEach(section => {
                if (!section.closest('#adminDashboard')) {
                    section.style.display = 'block';
                }
            });
            
            document.getElementById('adminDashboard').classList.add('hidden');
        }

        // Protected dashboard access
        function accessDashboard() {
            if (!currentUser || currentUser.role !== 'admin') {
                Swal.fire({
                    title: 'Akses Terbatas!',
                    text: 'Anda harus login sebagai admin untuk mengakses dashboard.',
                    icon: 'warning',
                    background: '#1a1a2e',
                    color: '#ffffff',
                    confirmButtonColor: '#667eea',
                    confirmButtonText: 'Login Sekarang',
                    width: '90%',
                    padding: '1rem',
                    customClass: {
                        popup: 'mobile-swal-popup',
                        title: 'mobile-swal-title',
                        content: 'mobile-swal-content'
                    }
                }).then(() => {
                    showLogin();
                });
                return;
            }
            showDashboard();
        }

        async function updateDashboardStats() {
            try {
                // Get fresh data from database
                const stats = await db.getStatistics();
                
                // Animate numbers
                animateNumber('totalSiswa', stats.totalStudents);
                animateNumber('siswaRPL', stats.studentsRPL);
                animateNumber('siswaTKJ', stats.studentsTKJ);
                
                // Update students array for compatibility
                students = await db.getAllStudents();
                
                console.log('Dashboard stats updated:', stats);
            } catch (error) {
                console.error('Error updating dashboard stats:', error);
                showNotification('Error updating statistics', 'error');
            }
        }

        function animateNumber(elementId, targetNumber) {
            const element = document.getElementById(elementId);
            let currentNumber = 0;
            const increment = targetNumber / 30;
            
            const timer = setInterval(() => {
                currentNumber += increment;
                if (currentNumber >= targetNumber) {
                    currentNumber = targetNumber;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(currentNumber);
            }, 50);
        }

        async function loadStudentData() {
            const tbody = document.getElementById('studentTableBody');
            
            try {
                // Show loading state
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-8 text-center">
                            <div class="flex items-center justify-center">
                                <div class="loading-spinner mr-3"></div>
                                <span class="text-gray-400">Memuat data siswa...</span>
                            </div>
                        </td>
                    </tr>
                `;
                
                // Get fresh data from database
                students = await db.getAllStudents();
                
                // Clear loading state
                tbody.innerHTML = '';
                
                if (students.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="8" class="px-6 py-8 text-center text-gray-400">
                                <i class="fas fa-users text-4xl mb-4 block"></i>
                                <p class="text-lg font-medium">Belum ada data siswa</p>
                                <p class="text-sm">Data siswa yang mendaftar akan muncul di sini</p>
                            </td>
                        </tr>
                    `;
                    return;
                }

                students.forEach((student, index) => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-800 transition-all duration-300';
                    
                    // Format dates
                    const createdDate = student.createdAt ? 
                        new Date(student.createdAt).toLocaleDateString('id-ID', {
                            day: '2-digit',
                            month: '2-digit', 
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        }) : student.tanggalDaftar;
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 text-sm">${index + 1}</td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-gradient-to-r ${student.jurusan === 'RPL' ? 'from-blue-500 to-purple-600' : 'from-green-500 to-teal-600'} rounded-full flex items-center justify-center mr-3">
                                    <span class="text-white text-xs font-bold">${student.namaLengkap.charAt(0)}</span>
                                </div>
                                <div>
                                    <p class="font-medium">${student.namaLengkap}</p>
                                    <p class="text-xs text-gray-400">ID: #${student.id}</p>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <span class="font-mono">${student.nisn}</span>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <span class="px-2 py-1 bg-gray-700 rounded text-xs font-bold">${student.kelas}</span>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <span class="px-3 py-1 rounded-full text-xs font-bold ${student.jurusan === 'RPL' ? 'bg-blue-500' : 'bg-green-500'} text-white">
                                ${student.jurusan}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <a href="mailto:${student.email}" class="text-blue-400 hover:text-blue-300 transition-colors">
                                ${student.email}
                            </a>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <a href="tel:${student.telepon}" class="text-green-400 hover:text-green-300 transition-colors">
                                ${student.telepon}
                            </a>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            <div class="text-xs">
                                <p class="font-medium">${createdDate}</p>
                                ${student.status ? `<span class="px-2 py-1 bg-green-600 rounded text-xs">${student.status}</span>` : ''}
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                console.log(`Loaded ${students.length} students in table`);
                
            } catch (error) {
                console.error('Error loading student data:', error);
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-8 text-center text-red-400">
                            <i class="fas fa-exclamation-triangle text-4xl mb-4 block"></i>
                            <p class="text-lg font-medium">Error loading data</p>
                            <p class="text-sm">${error.message}</p>
                            <button onclick="loadStudentData()" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                                <i class="fas fa-refresh mr-2"></i>Coba Lagi
                            </button>
                        </td>
                    </tr>
                `;
            }
        }

        function updateTodayDate() {
            const today = new Date().toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('todayDate').textContent = today;
        }

        // Enhanced Action Functions with Database Integration
        async function exportToExcel() {
            try {
                // Get fresh data from database
                const exportData = await db.exportData();
                const students = exportData.students;
                
                if (students.length === 0) {
                    showNotification('Tidak ada data untuk diekspor!', 'warning');
                    return;
                }

                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "No,ID,Nama Lengkap,NISN,Kelas,Jurusan,Email,Telepon,Alamat,Tanggal Daftar,Status,Dibuat,Diupdate\n";
                
                students.forEach((student, index) => {
                    const row = [
                        index + 1,
                        student.id || '',
                        student.namaLengkap,
                        student.nisn,
                        student.kelas,
                        student.jurusan,
                        student.email,
                        student.telepon,
                        student.alamat.replace(/,/g, ';'),
                        student.tanggalDaftar,
                        student.status || 'active',
                        student.createdAt ? new Date(student.createdAt).toLocaleString('id-ID') : '',
                        student.updatedAt ? new Date(student.updatedAt).toLocaleString('id-ID') : ''
                    ].join(',');
                    csvContent += row + "\n";
                });

                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `data_siswa_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Log export activity
                await db.logActivity('data_exported', `Exported ${students.length} students to CSV`);
                
                showNotification(`Data berhasil diekspor! ${students.length} siswa`, 'success');
                
            } catch (error) {
                console.error('Export error:', error);
                showNotification('Error saat mengekspor data', 'error');
            }
        }

        async function refreshData() {
            try {
                await updateDashboardStats();
                await loadStudentData();
                updateTodayDate();
                
                await db.logActivity('data_refreshed', 'Dashboard data refreshed');
                showNotification('Data berhasil direfresh!', 'success');
                
            } catch (error) {
                console.error('Refresh error:', error);
                showNotification('Error saat refresh data', 'error');
            }
        }

        async function viewReports() {
            try {
                const stats = await db.getStatistics();
                const logs = await db.getActivityLogs(10);
                
                const recentActivity = logs.map(log => 
                    ` ${new Date(log.timestamp).toLocaleString('id-ID')}: ${log.description}`
                ).join('\n');
                
                const report = `
                     LAPORAN STATISTIK SISWA
                    
                    Total Siswa: ${stats.totalStudents}
                    Siswa RPL: ${stats.studentsRPL} (${stats.totalStudents > 0 ? Math.round((stats.studentsRPL/stats.totalStudents)*100) : 0}%)
                    Siswa TKJ: ${stats.studentsTKJ} (${stats.totalStudents > 0 ? Math.round((stats.studentsTKJ/stats.totalStudents)*100) : 0}%)
                    Pendaftaran Minggu Ini: ${stats.recentRegistrations}
                    
                     AKTIVITAS TERBARU:
                    ${recentActivity || 'Belum ada aktivitas'}
                    
                    Tanggal: ${new Date().toLocaleDateString('id-ID')}
                    Database: ${db.db ? 'IndexedDB' : 'LocalStorage'}
                `;
                
                Swal.fire({
                    title: 'Laporan Statistik & Aktivitas',
                    text: report,
                    icon: 'info',
                    background: '#1a1a2e',
                    color: '#ffffff',
                    confirmButtonColor: '#667eea',
                    width: '95%',
                    padding: '1rem',
                    customClass: {
                        popup: 'mobile-swal-popup',
                        title: 'mobile-swal-title',
                        content: 'mobile-swal-content'
                    }
                });
                
                await db.logActivity('report_viewed', 'Statistics report viewed');
                
            } catch (error) {
                console.error('Report error:', error);
                showNotification('Error saat membuat laporan', 'error');
            }
        }

        // New Database Management Functions
        async function backupDatabase() {
            try {
                const exportData = await db.exportData();
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `mls_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                await db.logActivity('database_backup', `Database backup created with ${exportData.students.length} students`);
                showNotification('Backup database berhasil dibuat!', 'success');
                
            } catch (error) {
                console.error('Backup error:', error);
                showNotification('Error saat membuat backup', 'error');
            }
        }

        async function restoreDatabase() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = async (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                try {
                    const text = await file.text();
                    const data = JSON.parse(text);
                    
                    const result = await Swal.fire({
                        title: 'Konfirmasi Restore',
                        html: `
                            <p>Anda akan mengembalikan database dengan:</p>
                            <ul class="text-left mt-3">
                                <li> ${data.students?.length || 0} data siswa</li>
                                <li> ${data.logs?.length || 0} log aktivitas</li>
                                <li> Tanggal backup: ${new Date(data.exportDate).toLocaleString('id-ID')}</li>
                            </ul>
                            <p class="text-red-400 mt-3"><strong>Peringatan:</strong> Data saat ini akan dihapus!</p>
                        `,
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#d33',
                        cancelButtonColor: '#3085d6',
                        confirmButtonText: 'Ya, Restore!',
                        cancelButtonText: 'Batal',
                        background: '#1a1a2e',
                        color: '#ffffff',
                        width: '95%',
                        padding: '1rem',
                        customClass: {
                            popup: 'mobile-swal-popup',
                            title: 'mobile-swal-title',
                            content: 'mobile-swal-content'
                        }
                    });
                    
                    if (result.isConfirmed) {
                        const importResult = await db.importData(data);
                        
                        // Refresh dashboard
                        await updateDashboardStats();
                        await loadStudentData();
                        
                        Swal.fire({
                            title: 'Restore Berhasil!',
                            text: `${importResult.imported} data siswa berhasil dikembalikan`,
                            icon: 'success',
                            background: '#1a1a2e',
                            color: '#ffffff',
                            confirmButtonColor: '#667eea',
                            width: '90%',
                            padding: '1rem',
                            customClass: {
                                popup: 'mobile-swal-popup',
                                title: 'mobile-swal-title',
                                content: 'mobile-swal-content'
                            }
                        });
                    }
                    
                } catch (error) {
                    console.error('Restore error:', error);
                    Swal.fire({
                        title: 'Error!',
                        text: 'File backup tidak valid atau rusak',
                        icon: 'error',
                        background: '#1a1a2e',
                        color: '#ffffff',
                        confirmButtonColor: '#d33',
                        width: '90%',
                        padding: '1rem',
                        customClass: {
                            popup: 'mobile-swal-popup',
                            title: 'mobile-swal-title',
                            content: 'mobile-swal-content'
                        }
                    });
                }
            };
            
            input.click();
        }

        async function clearDatabase() {
            const result = await Swal.fire({
                title: 'Hapus Semua Data?',
                text: 'Semua data siswa dan log aktivitas akan dihapus permanen!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Ya, Hapus Semua!',
                cancelButtonText: 'Batal',
                background: '#1a1a2e',
                color: '#ffffff',
                width: '90%',
                padding: '1rem',
                customClass: {
                    popup: 'mobile-swal-popup',
                    title: 'mobile-swal-title',
                    content: 'mobile-swal-content'
                }
            });
            
            if (result.isConfirmed) {
                try {
                    // Clear database
                    if (db.db) {
                        const transaction = db.db.transaction(['students', 'logs'], 'readwrite');
                        await Promise.all([
                            new Promise(resolve => {
                                const request = transaction.objectStore('students').clear();
                                request.onsuccess = () => resolve();
                            }),
                            new Promise(resolve => {
                                const request = transaction.objectStore('logs').clear();
                                request.onsuccess = () => resolve();
                            })
                        ]);
                    } else {
                        localStorage.removeItem('students');
                        localStorage.removeItem('logs');
                    }
                    
                    // Refresh dashboard
                    students = [];
                    await updateDashboardStats();
                    await loadStudentData();
                    
                    await db.logActivity('database_cleared', 'All data cleared from database');
                    
                    Swal.fire({
                        title: 'Data Terhapus!',
                        text: 'Semua data berhasil dihapus dari database',
                        icon: 'success',
                        background: '#1a1a2e',
                        color: '#ffffff',
                        confirmButtonColor: '#667eea',
                        width: '90%',
                        padding: '1rem',
                        customClass: {
                            popup: 'mobile-swal-popup',
                            title: 'mobile-swal-title',
                            content: 'mobile-swal-content'
                        }
                    });
                    
                } catch (error) {
                    console.error('Clear database error:', error);
                    showNotification('Error saat menghapus database', 'error');
                }
            }
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notificationArea = document.getElementById('notificationArea');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'from-green-500 to-emerald-600',
                error: 'from-red-500 to-pink-600',
                warning: 'from-yellow-500 to-orange-600',
                info: 'from-blue-500 to-cyan-600'
            };
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            notification.className = `notification bg-gradient-to-r ${colors[type]} border border-white border-opacity-20`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="${icons[type]} mr-3 text-xl"></i>
                    <span class="font-medium">${message}</span>
                </div>
            `;
            
            notificationArea.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    notificationArea.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // Scroll Reveal Animation
        function revealOnScroll() {
            const reveals = document.querySelectorAll('.scroll-reveal');
            
            reveals.forEach(element => {
                const windowHeight = window.innerHeight;
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < windowHeight - elementVisible) {
                    element.classList.add('revealed');
                }
            });
        }

        // Performance optimization for mobile
        function optimizeForMobile() {
            const isMobile = window.innerWidth <= 768;
            const isTablet = window.innerWidth <= 1024 && window.innerWidth > 768;
            
            if (isMobile || isTablet) {
                // Disable heavy animations on mobile
                const heavyAnimations = document.querySelectorAll('.cyber-scan, .pulse-ring, .data-flow, .cyber-grid');
                heavyAnimations.forEach(el => {
                    el.style.display = 'none';
                    el.remove(); // Remove from DOM to save memory
                });
                
                // Reduce animation duration
                document.documentElement.style.setProperty('--animation-duration', '0.2s');
                
                // Disable complex gradients on mobile
                const gradientElements = document.querySelectorAll('.ultra-modern-bg, .dashboard-bg');
                gradientElements.forEach(el => {
                    el.style.background = '#0f0f23';
                });
                
                // Optimize scroll performance with throttling
                let scrollTimeout;
                function throttledScrollHandler() {
                    if (scrollTimeout) return;
                    scrollTimeout = setTimeout(() => {
                        revealOnScroll();
                        scrollTimeout = null;
                    }, 16); // ~60fps
                }
                
                window.removeEventListener('scroll', revealOnScroll);
                window.addEventListener('scroll', throttledScrollHandler, { passive: true });
                
                // Reduce DOM complexity
                const complexElements = document.querySelectorAll('.floating-shapes, .background-effects');
                complexElements.forEach(el => el.remove());
                
                // Enable GPU acceleration for key elements
                const keyElements = document.querySelectorAll('.ai-chat-button, .modern-card, .neon-btn');
                keyElements.forEach(el => {
                    el.style.transform = 'translateZ(0)';
                    el.style.willChange = 'transform';
                });
            }
        }

        // Debounced resize handler
        let resizeTimeout;
        function handleResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(optimizeForMobile, 250);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            // Performance optimization
            optimizeForMobile();
            window.addEventListener('resize', handleResize);
            
            // Initialize database and load data
            try {
                // Wait for database to be ready
                while (!db.isInitialized) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                // Update database status indicators
                const dbStatus = document.getElementById('dbStatus');
                const dbConnection = document.getElementById('dbConnection');
                
                if (dbStatus && dbConnection) {
                    dbStatus.textContent = db.db ? 'IndexedDB' : 'LocalStorage';
                    dbConnection.textContent = 'Connected';
                    dbConnection.className = 'font-mono text-green-400';
                }
                
                // Load initial data
                await loadStudentsFromDB();
                
                console.log('Database initialized:', {
                    type: db.db ? 'IndexedDB' : 'LocalStorage',
                    studentsCount: students.length
                });
                
                // Log application start
                await db.logActivity('app_started', 'Application initialized successfully');
                
            } catch (error) {
                console.error('Database initialization error:', error);
                
                // Update status indicators
                const dbConnection = document.getElementById('dbConnection');
                if (dbConnection) {
                    dbConnection.textContent = 'Error';
                    dbConnection.className = 'font-mono text-red-400';
                }
                
                showNotification('Database initialization failed', 'error');
            }
            
            // Check if user is already logged in
            if (currentUser && currentUser.role === 'admin') {
                showNotification('Selamat datang kembali, Admin!', 'success');
                
                // Log admin login
                try {
                    await db.logActivity('admin_login', 'Admin logged in (session restored)');
                } catch (error) {
                    console.error('Error logging admin login:', error);
                }
            }
            
            // Add scroll reveal with performance optimization
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                // Simplified scroll reveal for mobile
                setTimeout(() => {
                    document.querySelectorAll('.scroll-reveal').forEach(el => {
                        el.classList.add('revealed');
                    });
                }, 100);
            } else {
                window.addEventListener('scroll', revealOnScroll);
                setTimeout(revealOnScroll, 100);
            }
            
            // Add keyboard shortcuts - Fixed ESC key detection
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' || e.keyCode === 27) {
                    // Close any open modal - check each modal individually
                    const aboutModal = document.getElementById('aboutModal');
                    const loginModal = document.getElementById('loginModal');
                    const registerModal = document.getElementById('registerModal');
                    const aiChatModal = document.getElementById('aiChatModal');
                    
                    // Close AI Chat modal if open
                    if (aiChatModal && aiChatModal.style.display === 'flex') {
                        toggleAIChat();
                        return;
                    }
                    
                    // Close About modal if open
                    if (aboutModal && !aboutModal.classList.contains('hidden')) {
                        hideAbout();
                        return;
                    }
                    
                    // Close Login modal if open
                    if (loginModal && !loginModal.classList.contains('hidden')) {
                        hideLogin();
                        return;
                    }
                    
                    // Close Register modal if open
                    if (registerModal && !registerModal.classList.contains('hidden')) {
                        hideRegister();
                        return;
                    }
                }
                
                // Admin shortcuts
                if (currentUser && currentUser.role === 'admin') {
                    if (e.ctrlKey && e.key === 'e') {
                        e.preventDefault();
                        exportToExcel();
                    }
                    if (e.ctrlKey && e.key === 'r') {
                        e.preventDefault();
                        refreshData();
                    }
                    if (e.ctrlKey && e.key === 'b') {
                        e.preventDefault();
                        backupDatabase();
                    }
                }
            });
            
            // Add click outside to close modals - Updated for new structure
            document.addEventListener('click', function(e) {
                // Close About modal - check if clicked on modal backdrop or container
                const aboutModal = document.getElementById('aboutModal');
                if ((e.target === aboutModal || e.target.classList.contains('modal-container')) && !aboutModal.classList.contains('hidden')) {
                    hideAbout();
                }
                
                // Close Login modal - check if clicked on modal backdrop or container
                const loginModal = document.getElementById('loginModal');
                if ((e.target === loginModal || e.target.classList.contains('modal-container')) && !loginModal.classList.contains('hidden')) {
                    hideLogin();
                }
                
                // Close Register modal - check if clicked on modal backdrop or container
                const registerModal = document.getElementById('registerModal');
                if ((e.target === registerModal || e.target.classList.contains('modal-container')) && !registerModal.classList.contains('hidden')) {
                    hideRegister();
                }
                
                // Close AI Chat modal - check if clicked on modal backdrop
                const aiChatModal = document.getElementById('aiChatModal');
                if (e.target === aiChatModal && aiChatModal.style.display === 'flex') {
                    toggleAIChat();
                }
            });
            
            // Update today's date
            updateTodayDate();
            
            // Auto-refresh data every 5 minutes if admin is logged in
            let autoRefreshInterval;
            if (currentUser && currentUser.role === 'admin') {
                autoRefreshInterval = setInterval(async () => {
                    try {
                        await loadStudentsFromDB();
                        console.log('Auto-refresh: Data updated');
                    } catch (error) {
                        console.error('Auto-refresh error:', error);
                    }
                }, 5 * 60 * 1000); // 5 minutes
            }
            
            // Cleanup function for memory management
            window.addEventListener('beforeunload', () => {
                if (autoRefreshInterval) {
                    clearInterval(autoRefreshInterval);
                }
                
                // Clear any pending timeouts
                if (resizeTimeout) {
                    clearTimeout(resizeTimeout);
                }
                
                // Close database connections
                if (db && db.db) {
                    db.db.close();
                }
            });
            
            // Preload critical resources with lazy loading
            if ('requestIdleCallback' in window) {
                requestIdleCallback(() => {
                    // Preload fonts and critical assets
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap';
                    link.as = 'style';
                    document.head.appendChild(link);
                    
                    // Lazy load non-critical features
                    setTimeout(() => {
                        // Initialize AI service only when needed
                        if (!window.aiServiceInitialized) {
                            window.aiServiceInitialized = true;
                        }
                        
                        // Preload dashboard components if admin
                        if (currentUser && currentUser.role === 'admin') {
                            const dashboardElements = document.querySelectorAll('#adminDashboard *');
                            dashboardElements.forEach(el => {
                                if (el.style) {
                                    el.style.willChange = 'auto';
                                }
                            });
                        }
                    }, 2000);
                });
            } else {
                // Fallback for browsers without requestIdleCallback
                setTimeout(() => {
                    const link = document.createElement('link');
                    link.rel = 'stylesheet';
                    link.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap';
                    document.head.appendChild(link);
                }, 100);
            }
            
            // Show welcome message
            setTimeout(() => {
                console.log(' MLS - SMKS Muhammadiyah 1 Genteng');
                console.log(' Database System Ready');
                console.log(' AI Customer Service Ready');
                console.log(' Application Loaded Successfully');
                
                // Show AI notification after 3 seconds
                setTimeout(() => {
                    const badge = document.getElementById('aiNotificationBadge');
                    if (badge && !aiService.isOpen) {
                        badge.style.display = 'flex';
                    }
                }, 3000);
            }, 1000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9729abf553889e40',t:'MTc1NTc3NDQ5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
